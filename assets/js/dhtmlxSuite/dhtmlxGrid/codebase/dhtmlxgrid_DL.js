var globalActiveDHTMLGridObject;String.prototype.PA=function(){return this.replace(/&nbsp;/g," ").replace(/(^[ \t]*)|([ \t]*$)/g,"")};function dhtmlxArray(a){return dhtmlXHeir(a||[],dhtmlxArray._master)};dhtmlxArray._master={bP:function(a){for(var b=0;b<this.length;b++)if(a==this[b])return b;return-1},ml:function(a,b){this[this.length]=null;for(var c=this.length-1;c>=a;c--)this[c]=this[c-1];this[a]=b},at:function(a){this.splice(a,1)},yk:function(a,b){var c=this[a];this[a]=this[b];this[b]=c}};function dhtmlXGridObject(a){if(_isIE)try{document.execCommand("BackgroundImageCache",!1,!0)}catch(b){}if(a)if(typeof a=="object"){if(this.aL=a,!this.aL.id)this.aL.id="cgrid2_"+this.uid()}else this.aL=document.getElementById(a);else this.aL=document.createElement("DIV"),this.aL.id="cgrid2_"+this.uid();this.aL.innerHTML="";dhtmlxEventable(this);var c=this;this.Wr=0;this.fontWidth=7;this.row=this.cell=null;this.iconURL="";this.editor=null;this.aP=this.UB= !0;this.combos=[];this.QL=[];this.bj={};this.aD=dhtmlxArray();this.am=dhtmlxArray();this._data_cache={};this.XC={};this._ud_enabled= !0;this.bA=new ag(this.vj,this,!0,this.ir);this._maskArr=[];this.bY=dhtmlxArray();this.bH={};this.vw=this.BN=0;this.aL.className+=" gridbox";this.aL.style.width=this.aL.getAttribute("width")||(window.getComputedStyle?this.aL.style.width||window.getComputedStyle(this.aL,null).width:this.aL.currentStyle?this.aL.currentStyle.width:this.aL.style.width||0)||"100%";this.aL.style.height=this.aL.getAttribute("height")||(window.getComputedStyle?this.aL.style.height||window.getComputedStyle(this.aL,null).height:this.aL.currentStyle?this.aL.currentStyle.height:this.aL.style.height||0)||"100%";this.aL.style.cursor="default";this.aL.onselectstart=function(){return!1};var d=function(e){var a=document.createElement("TABLE");a.cellSpacing=a.cellPadding=0;a.style.cssText="width:100%;table-layout:fixed;";a.className=e.substr(2);return a};this.obj=d("c_obj");this.hdr=d("c_hdr");this.hdr.style.marginRight="20px";this.hdr.style.paddingRight="20px";this.HF=document.createElement("DIV");this.HF.style.width="100%";this.HF.style.overflow="auto";this.HF.appendChild(this.obj);this.HF.className="objbox";this.kR=document.createElement("DIV");this.kR.style.width="100%";this.kR.style.height="25px";this.kR.style.overflow="hidden";this.kR.className="xhdr";this.sf=[];this.gB=document.createElement("IMG");this.gB.style.display="none";this.kR.appendChild(this.gB);this.kR.appendChild(this.hdr);this.kR.style.position="relative";this.aL.appendChild(this.kR);this.aL.appendChild(this.HF);this.aL.grid=this;this.HF.grid=this;this.kR.grid=this;this.obj.grid=this;this.hdr.grid=this;this.cellWidthPX=[];this.cellWidthPC=[];this.fL=this.aL.ajW||"px";this.gX=this.aL.delimiter||",";this.oU=",";this.hdrLabels=[];this.columnIds=[];this.columnColor=[];this._hrrar=[];this.cellType=dhtmlxArray();this.cellAlign=[];this.initCellWidth=[];this.fldSort=[];this.ig=_isIE&&document.compatMode!="BackCompat"?22:20;this.eg=window.fe||"";this.ft= !1;this.oB= !0;this.aW=this.pH= !1;this.cu=0;dhtmlxEvent(window,"unload",function(){try{c.fA&&c.fA()}catch(e){}});this.setSkin=function(e){this.skin_name=e;var a=this.aL.className.split(" gridbox")[0];this.aL.className=a+" gridbox gridbox_"+e;this.skin_h_correction=0;this.enableAlterCss("ev_"+e,"odd_"+e,this.gY());this._fixAlterCss();switch(e){case "clear":this.FD=document.createElement("DIV");this.FD.className="topMumba";this.FD.innerHTML="<img style='left:0px'   src='"+this.eg+"skinC_top_left.gif'><img style='right:20px' src='"+this.eg+"skinC_top_right.gif'>";this.aL.appendChild(this.FD);this.Gc=document.createElement("DIV");this.Gc.className="bottomMumba";this.Gc.innerHTML="<img style='left:0px'   src='"+this.eg+"skinD_bottom_left.gif'><img style='right:20px' src='"+this.eg+"skinD_bottom_right.gif'>";this.aL.appendChild(this.Gc);if(this.aL.style.position!="absolute")this.aL.style.position="relative";this.skin_h_correction=20;break;case "white":this.ig=40;this.qW= !0;break;case "dhx_skyblue":case "dhx_web":case "glassy_blue":case "dhx_black":case "dhx_blue":case "modern":case "light":this.ig=20;this.qW= !0;break;case "xp":this.qW= !0;this.ig=_isIE&&document.compatMode!="BackCompat"?26:22;break;case "mt":this.ig=_isIE&&document.compatMode!="BackCompat"?26:22;break;case "gray":if(_isIE&&document.compatMode!="BackCompat")this.ig=22}if(_isIE&&this.hdr){var b=this.hdr.parentNode;b.removeChild(this.hdr);b.appendChild(this.hdr)}this.setSizes()};_isIE&&this.vq(!0);if(window.dhtmlDragAndDropObject)this.ae=new dhtmlDragAndDropObject;this._doOnScroll=function(e,a){this.callEvent("onScroll",[this.HF.scrollLeft,this.HF.scrollTop]);this.BD(e,a)};this.BD=function(e,a){this.kR.scrollLeft=this.HF.scrollLeft;if(this.ftr)this.ftr.parentNode.scrollLeft=this.HF.scrollLeft;if(!a&&this.ahK)this.ee&&window.clearTimeout(this.ee),this.ee=window.setTimeout(function(){c._update_srnd_view&&c._update_srnd_view()},100)};this.qu=function(e){e.appendChild(this.globalBox?this.globalBox:this.aL);this.setSizes()};this.init=function(e){if(this.gY()&& !this._h2){this._h2=new dhtmlxHierarchy;if(this.aC&& !this.nh)this.aC._h2=this._h2;this.kj={eg:null}}if(this.Oi){this.editStop();this.ij=this.yH=this.resized=this.Ms=null;this.cellWidthPX=[];this.cellWidthPC=[];this.hdr.rows.length>0&&this.clearAll(!0);for(var a=this.hdr.insertRow(0),b=0;b<this.hdrLabels.length;b++)a.appendChild(document.createElement("TH")),a.childNodes[b]._cellIndex=b,a.childNodes[b].style.height="0px";_isIE&&_isIE<8?a.style.position="absolute":a.style.height="auto";a=this.hdr.insertRow(cn?2:1);a.bq=[];for(var g=0,b=0;b<this.hdrLabels.length;b++)a.bq[b]=b-g,this.hdrLabels[b]==this.JP&&b!=0?(cn&&a.insertCell(b-g),a.cells[b-g-1].colSpan=(a.cells[b-g-1].colSpan||1)+1,a.childNodes[b-g-1]._cellIndex++,g++,a.bq[b]=b-g):(a.insertCell(b-g),a.childNodes[b-g]._cellIndex=b,a.childNodes[b-g]._cellIndexS=b,this.adA(b,this.hdrLabels[b]));if(g==0)a.bq=null;this.gA=this.hdrLabels.length;_isIE&&window.setTimeout(function(){c.setSizes&&c.setSizes()},1);this.obj.firstChild||this.obj.appendChild(document.createElement("TBODY"));var d=this.obj.firstChild;if(!d.firstChild){d.appendChild(document.createElement("TR"));d=d.firstChild;_isIE&&_isIE<8?d.style.position="absolute":d.style.height="auto";for(b=0;b<this.hdrLabels.length;b++)d.appendChild(document.createElement("TH")),d.childNodes[b].style.height="0px"}this._c_order=null;this.hu!= !0&&(this.obj.className+=" row20px");this.gB.style.position="absolute";this.gB.style.display="none";this.gB.src=this.eg+"sort_desc.gif";this.gB.YR=0;this.sB?this.kR.style.display="none":this.sB= !1;this.Az&&this.FM();this.attachHeader();this.attachHeader(0,0,"_aFoot");this.setSizes();e&&this.On();this.obj.scrollTop=0;this.nz&&this.ae.eH(this.aL,this);this.CV&&this.Ve();this.Yz&&this.Yz()}};this.setColumnSizes=function(e){for(var a=0,b=[],c=0,d=0;d<this.gA;d++)if(this.initCellWidth[d]=="*"&& !this._hrrar[d])this.Gd= !1,b.push(d);else{if(this.fL=="%"){typeof this.cellWidthPC[d]=="undefined"&&(this.cellWidthPC[d]=this.initCellWidth[d]);var j=e*this.cellWidthPC[d]/100||0;c>0.5&&(j++,c--);var l=this.cellWidthPX[d]=Math.floor(j),c=c+j-l}else typeof this.cellWidthPX[d]=="undefined"&&(this.cellWidthPX[d]=this.initCellWidth[d]);this._hrrar[d]||(a+=this.cellWidthPX[d]*1)}if(b.length){var m=Math.floor((e-a)/b.length);m<0&&(m=1);for(d=0;d<b.length;d++){var k=Math.max(this._drsclmW?this._drsclmW[b[d]]||0:0,m);this.cellWidthPX[b[d]]=k;a+=k}if(e>a){var n=b[b.length-1];this.cellWidthPX[n]+=e-a;a=e}this.tZ()}this.obj.style.width=a+"px";this.hdr.style.width=a+"px";if(this.ftr)this.ftr.style.width=a+"px";this.Ue();return a};this.setSizes=function(){if(this.hdr.rows[0]){var e=this.quirks=_isIE&&document.compatMode=="BackCompat",a=(this.aL.offsetWidth-this.aL.clientWidth)/2;if(!this.dontSetSizes)if(this.globalBox){var b=(this.globalBox.offsetWidth-this.globalBox.clientWidth)/2;if(this._delta_x&& !this.nh){var g=this.globalBox.clientWidth;this.globalBox.style.width=this._delta_x;this.aL.style.width=Math.max(0,this.globalBox.clientWidth+(e?b*2:0)-this.aC.aL.clientWidth)+"px";g!=this.globalBox.clientWidth&&this.aC.rk(this.aC.aL.clientWidth)}if(this._delta_y&& !this.nh)this.globalBox.style.height=this._delta_y,this.aL.style.overflow=this.aC.aL.style.overflow="hidden",this.aL.style.height=this.aC.aL.style.height=this.globalBox.clientHeight+(e?b*2:0)+"px"}else{if(this._delta_x)this.aL.parentNode&&this.aL.parentNode.tagName=="TD"?(this.aL.style.width="1px",this.aL.style.width=parseInt(this._delta_x)*this.aL.parentNode.clientWidth/100-a*2+"px"):this.aL.style.width=this._delta_x;if(this._delta_y)this.aL.style.height=this._delta_y}window.clearTimeout(this.zY);if(!this.aL.offsetWidth&&(!this.globalBox|| !this.globalBox.offsetWidth))this.zY=window.setTimeout(function(){c.setSizes&&c.setSizes()},250);else{var d= !this._wthB&&(this.aL.arj||this._delta_x)&&(this.skin_name||"").indexOf("dhx")==0&& !e?2:0,j= !this._wthB&&(this.aL.arj||this._delta_y)&&(this.skin_name||"").indexOf("dhx")==0&& !e?2:0,l=this.parentGrid? !1:this.HF.scrollHeight>this.HF.offsetHeight,m=aq?18:18,k=this.aL.clientWidth-(this.skin_h_correction||0)*(e?0:1)-d,n=this.aL.clientWidth-(this.skin_h_correction||0)-d,o=this.aL.clientHeight-j,p=this.setColumnSizes(n-(l?m:0)-(this._correction_x||0)),r=this.parentGrid? !1:this.HF.scrollWidth>this.HF.offsetWidth||this.HF.style.overflowX=="scroll",s=this.hdr.clientHeight,t=this.ftr?this.ftr.clientHeight:0,u=k,q=o-s-t;this.Gd&&this.Gd[0]&&this.Gd[1]==99999&&(r=0);if(this.abK&&(q=this.aic?this.aL.parentNode.clientHeight-s-t:this.obj.offsetHeight+(r?m:0)+(this._correction_y||0),this.FF&&(q=this.aea?Math.min(this.FF,q+s+t)-s-t:Math.min(this.FF,q)),l&&q>=this.obj.scrollHeight+(r?m:0)))l= !1,this.setColumnSizes(n-(this._correction_x||0));if(this.Gd&&this.Gd[0]){if(this.fL=="%")this.fL="px";this.aC&&(p+=this.aC.aL.clientWidth);u=Math.min(Math.max(p+(l?m:0),this.Gd[2]),this.Gd[1])+(this._correction_x||0);this.aC&&(u-=this.aC.aL.clientWidth)}q=Math.max(0,q);this._ff_size_delta=this._ff_size_delta==0.1?0.2:0.1;if(!aq)this._ff_size_delta=0;if(!this.dontSetSizes)this.aL.style.width=Math.max(0,u+(e?2:0)*a+this._ff_size_delta)+"px",this.aL.style.height=q+(e?2:0)*a+s+t+"px";this.HF.style.height=q+(e&& !l?2:0)*a+"px";this.kR.style.height=s+"px";q!=o&&this.BD(0,!this.ahK);var v=this["setSizes_"+this.skin_name];v&&v.call(this);this.vo();s!=this.hdr.clientHeight&&this.abK&&this.setSizes();this.callEvent("onSetSizes",[])}}};this.setSizes_clear=function(){var e=this.hdr.offsetHeight,a=this.aL.offsetWidth,b=e+this.HF.offsetHeight;this.FD.style.top=(e||0)+"px";this.FD.style.width=a+20+"px";this.Gc.style.top=b-3+"px";this.Gc.style.width=a+20+"px"};this.Ue=function(){if(cU&&this.ftr)this.ftr.width=this.HF.scrollWidth+"px";for(var e=this.gA,a=0;a<e;a++)if(this.hdr.rows[0].cells[a].style.width=this.cellWidthPX[a]+"px",this.obj.rows[0].childNodes[a].style.width=this.cellWidthPX[a]+"px",this.ftr)this.ftr.rows[0].cells[a].style.width=this.cellWidthPX[a]+"px"};this.alX=function(a){this.gX=a};this.setInitWidthsP=function(a,b){this.fL="%";this.initCellWidth=a.split(this.gX.replace(/px/gi,""));b||this.tZ()};this.tZ=function(){if(!this.nh){var a=window,b=this;dhtmlxEvent(window,"resize",function(){window.clearTimeout(b.rJ);if(b.tZ)b.rJ=window.setTimeout(function(){b.setSizes&&b.setSizes();b.aC&&b.aC.rk()},100)})}};this.setInitWidths=function(a){this.fL="px";this.initCellWidth=a.split(this.gX);if(aq)for(var b=0;b<this.initCellWidth.length;b++)this.initCellWidth[b]!="*"&&(this.initCellWidth[b]=parseInt(this.initCellWidth[b]))};this.enableMultiline=function(a){this.hu=ap(a)};this.enableMultiselect=function(a){this.gN=ap(a)};this.setImagesPath=this.setImagePath=function(a){this.eg=a};this.setIconsPath=this.setIconPath=function(a){this.iconURL=a};this.bX=function(a){var b=a.target||a.srcElement;b.tagName!="TD"&&(b=this.bw(b,"TD"));if(b){if(b.tagName=="TD"&&this.qZ&& !this.qZ[b._cellIndex])return b.style.cursor="default";var c=(a.layerX||0)+(!_isIE&&a.target.tagName=="DIV"?b.offsetLeft:0);b.style.cursor=b.offsetWidth-(a.offsetX||(parseInt(this.fI(b,this.kR))-c)* -1)<(cU?20:10)?"E-resize":"default";if(cU)this.kR.scrollLeft=this.HF.scrollLeft}};this.eJ=function(a){this.resized&&this.fN();this.resized=null;var b=a.target||a.srcElement;b.tagName!="TD"&&(b=this.bw(b,"TD"));var i=a.clientX,g=this.hdr.offsetWidth,d=parseInt(b.offsetWidth);if(b.tagName=="TD"&&b.style.cursor!="default"&&(!this.qZ||this.qZ[b._cellIndex]))c._old_d_mm=document.body.onmousemove,c._old_d_mu=document.body.onmouseup,document.body.onmousemove=function(a){c&&c.EO(a||window.event,b,d,i,g)},document.body.onmouseup=function(){c&&c.fN()}};this.fN=function(){document.body.onmousemove=c._old_d_mm||"";document.body.onmouseup=c._old_d_mu||"";this.setSizes();this.BD(0,1);this.callEvent("onResizeEnd",[this])};this.EO=function(a,b,c,g,d){b.style.cursor="E-resize";this.resized=b;var j=c+(a.clientX-g),l=d+(a.clientX-g);if(this.callEvent("onResize",[b._cellIndex,j,this])){if(_isIE)this.HF.scrollLeft=this.kR.scrollLeft;if(b.colSpan>1){for(var m=[],k=0;k<b.colSpan;k++)m[k]=Math.round(j*this.hdr.rows[0].childNodes[b._cellIndexS+k].offsetWidth/b.offsetWidth);for(k=0;k<b.colSpan;k++)this.si(b._cellIndexS+k*1,m[k])}else this.si(b._cellIndex,j);this.BD(0,1);this.setSizes();this.aC&&this.Gd&&this.aC.rk()}};this.si=function(a,b){if(b>(this._drsclmW&& !this.Hc?this._drsclmW[a]||10:10)){this.obj.rows[0].childNodes[a].style.width=b+"px";this.hdr.rows[0].childNodes[a].style.width=b+"px";if(this.ftr)this.ftr.rows[0].childNodes[a].style.width=b+"px";if(this.fL=="px")this.cellWidthPX[a]=b;else{var c=parseInt(this.aL.offsetWidth);this.HF.scrollHeight>this.HF.offsetHeight&&(c-=17);var g=Math.round(b/c*100);this.cellWidthPC[a]=g}this.gB.style.display!="none"&&this.vo()}};this.co=function(a,b,c,g){c=(c||"asc").toLowerCase();if(ap(a)){this.gB.src=c=="asc"?this.eg+"sort_asc.gif":this.eg+"sort_desc.gif";this.gB.style.display="";this.ij=this.hdr.rows[0].childNodes[b];var d=this.hdr.rows[g||1];if(d){for(var j=0;j<d.childNodes.length;j++)if(d.childNodes[j]._cellIndexS==b)return this.yH=d.childNodes[j],this.vo();return this.co(a,b,c,(g||1)+1)}}else this.gB.style.display="none",this.ij=this.yH=null};this.vo=function(a,b,c,g){if(!this._hrrar|| !this._hrrar[this.yH?this.yH._cellIndex:a])if(g||(g=a?this.hdr.rows[c||0].cells[a]:this.yH),g!=null){var d=this.fI(g,this.kR),j=g.offsetWidth;this.gB.style.left=Number(d[0]+j-13)+"px";this.gB.YR=parseInt(this.gB.style.left);this.gB.style.top=Number(d[1]+5)+"px";if(!this.pH&& !b)this.gB.style.display="inline";this.gB.style.left=this.gB.YR+"px"}};this.setActive=function(a){arguments.length==0&&(a= !0);a== !0?(globalActiveDHTMLGridObject&&globalActiveDHTMLGridObject!=this&&(globalActiveDHTMLGridObject.editStop(),globalActiveDHTMLGridObject.callEvent("onBlur",[globalActiveDHTMLGridObject])),globalActiveDHTMLGridObject=this,this.ft= !0):(this.ft= !1,this.callEvent("onBlur",[this]))};this.aV=function(a){var b=0,c=this.bw(_isIE?a.srcElement:a.target,"TD");if(c){var d= !0;if(this.markedCells){var f=0;if(a.shiftKey||a.metaKey)f=1;a.ctrlKey&&(f=2);this.doMark(c,f);return!0}if(this.gN!= !1&&(a.shiftKey&&this.row!=null&&this.bY.length&&(b=1),a.ctrlKey||a.metaKey))b=2;this.doClick(c,d,b)}};this._doContClick=function(a){var b=this.bw(_isIE?a.srcElement:a.target,"TD");if(!b||typeof b.parentNode.idd=="undefined")return this.callEvent("onEmptyClick",[a]),!0;if(a.button==2||gP&&a.ctrlKey){if(!this.callEvent("onRightClick",[b.parentNode.idd,b._cellIndex,a])){var c=function(a){(a||event).cancelBubble= !0;return!1};(a.srcElement||a.target).oncontextmenu=c;return c(a)}if(this.Gs){if(!this.callEvent("onBeforeContextMenu",[b.parentNode.idd,b._cellIndex,this]))return!0;if(_isIE)a.srcElement.oncontextmenu=function(){event.cancelBubble= !0;return!1};if(this.Gs.showContextMenu){var d=window.document.documentElement,f=window.document.body,j=[d.scrollLeft||f.scrollLeft,d.scrollTop||f.scrollTop];if(_isIE)var l=a.clientX+j[0],m=a.clientY+j[1];else l=a.pageX,m=a.pageY;this.Gs.showContextMenu(l-1,m-1);this.contextID=this.Gs.contextMenuZoneId=b.parentNode.idd+"_"+b._cellIndex;this.Gs._skip_hide= !0}else b.contextMenuId=b.parentNode.idd+"_"+b._cellIndex,b.contextMenu=this.Gs,b.a=this.Gs.vm,b.a(b,a),b.a=null;a.cancelBubble= !0;return!1}}else this.Gs&&(this.Gs.hideContextMenu?this.Gs.hideContextMenu():this.Gs.ES());return!0};this.doClick=function(a,b,d,g){this.gN||(d=0);var f=this.row?this.row.idd:0;this.setActive(!0);d||(d=0);if(this.cell!=null)this.cell.className=this.cell.className.replace(/cellselected/g,"");if(a.tagName=="TD"){if(this.mR("onSelectStateChanged"))var j=this.bI();var l=this.row;if(d==1){var m=this.am.bP(a.parentNode),k=this.am.bP(this.Ms);if(m>k)var n=k,o=m;else n=m,o=k;for(var p=0;p<this.am.length;p++)if(p>=n&&p<=o)if(this.am[p]&& !this.am[p].kp)this.am[p].className.indexOf("rowselected")== -1&&this.callEvent("onBeforeSelect",[this.am[p].idd,f])&&(this.am[p].className+=" rowselected",this.bY[this.bY.length]=this.am[p]);else return this.pL(),this.doClick(a,b,0,g)}else if(d==2&&a.parentNode.className.indexOf("rowselected")!= -1){a.parentNode.className=a.parentNode.className.replace(/rowselected/g,"");this.bY.at(this.bY.bP(a.parentNode));var r= !0,g= !1}this.editStop();if(typeof a.parentNode.idd=="undefined")return!0;if(!r&& !a.parentNode.kp)if(this.callEvent("onBeforeSelect",[a.parentNode.idd,f]))if(this.acg()!=a.parentNode.idd){d==0&&this.pL();this.cell=a;l==a.parentNode&&this.adC&&(b= !1);this.row=a.parentNode;this.row.className+=" rowselected";if(this.cell&&_isIE&&_isIE==8){var s=this.cell.nextSibling,t=this.cell.parentNode;t.removeChild(this.cell);t.insertBefore(this.cell,s)}if(this.bY.bP(this.row)== -1)this.bY[this.bY.length]=this.row}else this.cell=a,this.row=a.parentNode;else b= !1;if(this.cell&&this.cell.parentNode.className.indexOf("rowselected")!= -1)this.cell.className=this.cell.className.replace(/cellselected/g,"")+" cellselected";if(d!=1&& !this.row)return;this.Ms=a.parentNode;var u=this.row.idd,q=this.cell;b&&typeof u!="undefined"&&q&& !r?c.Ti=setTimeout(function(){c.callEvent&&c.callEvent("onRowSelect",[u,q._cellIndex])},100):this.callEvent("onRowSelectRSOnly",[u]);if(this.mR("onSelectStateChanged")){var v=this.bI();j!=v&&this.callEvent("onSelectStateChanged",[v,j])}}this.ft= !0;g!== !1&&this.cell&&this.cell.parentNode.idd&&this.HZ(this.cell)};this.adx=function(){this.pL();var a=this.aD;if(this.aW)a=this.am;for(var b=0;b<a.length;b++)this.render_row(b).className+=" rowselected";this.bY=dhtmlxArray([].concat(a));if(this.bY.length)this.row=this.bY[0],this.cell=this.row.cells[0];this.aC&& !this.nh&&this.aC.adx()};this.eQ=function(a,b,c,d,f,j){c||(c= !1);typeof a!="object"&&(a=this.render_row(a));if(!a||a== -1)return null;var l=a.bq?a.childNodes[a.bq[b]]:a.childNodes[b];l||(l=a.childNodes[0]);this.markedCells?this.doMark(l,d?2:0):d?this.doClick(l,c,3,j):this.doClick(l,c,0,j);f&&this.gh()};this.HZ=function(a,b){if(this.aW){var c=Math.floor(this.getRowIndex(a.parentNode.idd)/this.cu)+1;c!=this.ew&&this.changePage(c)}try{if(a.offsetHeight){var d=a.offsetLeft+a.offsetWidth+20,f=0;d>this.HF.offsetWidth+this.HF.scrollLeft?a.offsetLeft>this.HF.scrollLeft&&(f=a.offsetLeft-5):a.offsetLeft<this.HF.scrollLeft&&(d-=a.offsetWidth*2/3,d<this.HF.scrollLeft&&(f=a.offsetLeft-5));if(f&& !b)this.HF.scrollLeft=f}if(a.offsetHeight)d=a.offsetTop;else var j=this.nh?this.aC.bj[a.parentNode.idd]:a.parentNode,d=this.aD.bP(j)*this.ig;var l=d+a.offsetHeight+38;if(l>this.HF.offsetHeight+this.HF.scrollTop)var m=l-this.HF.offsetHeight;else d<this.HF.scrollTop&&(m=d-5);if(m)this.HF.scrollTop=m}catch(k){}};this.gh=function(){if(!(this.editor&&this.cell==this.editor.cell)){this.editStop();if(this.oB!= !0|| !this.cell)return!1;var a=this.cell;if(a.parentNode.FG)return!1;this.editor=this.cells4(a);if(this.editor!=null){if(this.editor.isDisabled())return this.editor=null,!1;this.callEvent("onEditCell",[0,this.row.idd,this.cell._cellIndex])!= !1&&this.editor.edit?(this.EH=(new Date).valueOf(),a.className+=" editable",this.editor.edit(),this.callEvent("onEditCell",[1,this.row.idd,this.cell._cellIndex])):this.editor=null}}};this.editStop=function(a){if(cU&&this.EH){if(this.EH*1+50>(new Date).valueOf())return;this.EH=null}if(this.editor&&this.editor!=null)if(this.editor.cell.className=this.editor.cell.className.replace("editable",""),a){var b=this.editor.val;this.editor.detach();this.editor.setValue(b);this.editor=null;this.callEvent("onEditCancel",[this.row.idd,this.cell._cellIndex,b])}else{if(this.editor.detach())this.cell.hy= !0;var c=this.editor;this.editor=null;var d=this.callEvent("onEditCell",[2,this.row.idd,this.cell._cellIndex,c.getValue(),c.val]);if(typeof d=="string"||typeof d=="number")c[c.hW?"setLabel":"setValue"](d);else if(!d)c[c.hW?"setLabel":"setValue"](c.val);this.abK&&this.hu&&this.setSizes()}};this.Yc=function(a,b,c){a=this.CE((this.pj?this.am:this.aD).bP(a),b);return!a?null:a.childNodes[a.bq?a.bq[c]:c]};this.Kn=function(a,b,c){var a=a||this.cell,d=a.parentNode;this.Wq?(c=this.Wq[a._cellIndex],typeof c!="undefined"&&(a=c<0?this.Yc(d,b,Math.abs(c)-1):d.childNodes[c])):(c=a._cellIndex+b,c>=0&&c<this.gA?(d.bq&&(c=d.bq[a._cellIndex]+b),a=d.childNodes[c]):a=this.Yc(d,b,b==1?0:this.gA-1));return!a?(b==1&&this.tabEnd&&(this.tabEnd.focus(),this.tabEnd.focus(),this.setActive(!1)),b== -1&&this.tabStart&&(this.tabStart.focus(),this.tabStart.focus(),this.setActive(!1)),null):a.style.display!="none"&&(!this.smartTabOrder|| !this.cells(a.parentNode.idd,a._cellIndex).isDisabled())?a:this.Kn(a,b)};this.CE=function(a,b){var c=this.render_row(a+b);return!c||c== -1?null:c&&c.style.display=="none"?this.CE(a+b,b):c};this.PP=function(a){if(this.aD.length){var b=this.nh?this.aC:this,c=Math.floor((b._r_select||this.getRowIndex(this.row.idd)||0)+a*this.HF.offsetHeight/(this.ig||20));c<0&&(c=0);c>=this.aD.length&&(c=this.aD.length-1);if(this.ahK&& !this.aD[c]){this.HF.scrollTop+=Math.floor(a*this.HF.offsetHeight/(this.ig||20))*(this.ig||20);if(this.aC)this.aC.HF.scrollTop=this.HF.scrollTop;b._r_select=c}else{this.eQ(c,this.cell._cellIndex,!0,!1,!1,this.hu||this.ahK);if(!this.hu&& !this.ahK&& !this.nh&&(this.HF.scrollTop=this.dz(this.bB(c)).offsetTop,this.aC))this.aC.HF.scrollTop=this.HF.scrollTop;b._r_select=null}}};this.bQ=function(a){if(!a)return!0;if((a.target||a.srcElement).value!==window.undefined){var b=a.target||a.srcElement;if(!b.parentNode||b.parentNode.className.indexOf("editable")== -1)return!0}if(globalActiveDHTMLGridObject&&this!=globalActiveDHTMLGridObject)return globalActiveDHTMLGridObject.bQ(a);if(this.ft== !1)return!0;if(this.Zl)return!0;if(!this.callEvent("onKeyPress",[a.keyCode,a.ctrlKey,a.shiftKey,a]))return!1;var c="k"+a.keyCode+"_"+(a.ctrlKey?1:0)+"_"+(a.shiftKey?1:0);if(this.cell){if(this.zf[c]){if(!1===this.zf[c].call(this))return!0;a.preventDefault&&a.preventDefault();a.cancelBubble= !0;return!1}this.zf.k_other&&this.zf.k_other.call(this,a)}return!0};this.Th=function(a,b,c,d){typeof a!="object"&&(a=this.render_row(a));this.eQ(a,0,b,c,!1,d)};this.gF=function(a){var b=this.bw(_isIE?a.srcElement:a.target,"TD");if(b){var c=b.parentNode.idd;return this.callEvent("onRowDblClicked",[c,b._cellIndex])}};this.FJ=function(a,b){var c=this.grid,b=b||c.bw(_isIE?event.srcElement:a.target,"TD");if(this.grid.resized==null){if(!this.grid.callEvent("onHeaderClick",[b._cellIndexS,a||window.event]))return!1;c.adU(b._cellIndexS,!1,b)}this.grid.resized=null};this.Yb=function(){var a=this.bY.length;if(a!=0){var b=this.bY;this.bY=dhtmlxArray();for(var c=a-1;c>=0;c--){var d=b[c];if(this.deleteRow(d.idd,d)){if(d==this.row)var f=c}else this.bY[this.bY.length]=d}if(f)try{f+1>this.am.length&&f--,this.eQ(f,0,!0)}catch(j){this.cell=this.row=null}}};this.acg=function(){for(var a=[],b={},c=0;c<this.bY.length;c++){var d=this.bY[c].idd;b[d]||(a[a.length]=d,b[d]= !0)}return a.length==0?null:a.join(this.gX)};this.iL=function(){return this.cell!=null?this.cell._cellIndex: -1};this.yI=function(a){return parseInt(this.cellWidthPX[a])};this.setColWidth=function(a,b){if(b=="*")this.initCellWidth[a]="*";else{if(this._hrrar[a])return;this.fL=="px"?this.cellWidthPX[a]=parseInt(b):this.cellWidthPC[a]=parseInt(b)}this.setSizes()};this.getRowIndex=function(a){for(var b=0;b<this.aD.length;b++)if(this.aD[b]&&this.aD[b].idd==a)return b;return-1};this.bB=function(a){return this.aD[a]?this.aD[a].idd:this.undefined};this.agA=function(a,b){this.changeRowId(this.bB(a),b)};this.changeRowId=function(a,b){if(a!=b){var c=this.bj[a];c.idd=b;this.bH[a]&&(this.bH[b]=this.bH[a],this.bH[a]=null);if(this._h2&&this._h2.get[a])this._h2.get[b]=this._h2.get[a],this._h2.get[b].id=b,delete this._h2.get[a];this.bj[a]=null;this.bj[b]=c;for(var d=0;d<c.childNodes.length;d++)if(c.childNodes[d].Lq)c.childNodes[d].Lq=this.MB(c.childNodes[d].AB,c.childNodes[d]);if(this._mat_links&&this._mat_links[a]){var f=this._mat_links[a];delete this._mat_links[a];for(var j in f)for(d=0;d<f[j].length;d++)this.MB(f[j][d].eN,f[j][d])}this.callEvent("onRowIdChange",[a,b])}};this.setColumnIds=function(a){this.columnIds=a.split(this.gX)};this.amG=function(a,b){this.columnIds[a]=b};this.getColIndexById=function(a){for(var b=0;b<this.columnIds.length;b++)if(this.columnIds[b]==a)return b};this.getColumnId=function(a){return this.columnIds[a]};this.getColLabel=this.adE=function(a,b,c){for(var d=(c||this.hdr).rows[(b||0)+1],f=0;f<d.cells.length;f++)if(d.cells[f]._cellIndexS==a)return _isIE?d.cells[f].innerText:d.cells[f].textContent;return ""};this.getFooterLabel=function(a,b){return this.adE(a,b,this.ftr)};this.tG=function(a){var b=this.dz(a);if(b)b.style.fontWeight="bold"};this.setRowTextStyle=function(a,b){var c=this.dz(a);if(c)for(var d=0;d<c.childNodes.length;d++){var f=c.childNodes[d]._attrs.style||"";this._hrrar&&this._hrrar[d]&&(f="display:none;");c.childNodes[d].style.cssText=f+"width:"+c.childNodes[d].style.width+";"+b}};this.EA=function(a,b){for(var c=this.dz(a),d=0;d<c.childNodes.length;d++)c.childNodes[d].bgColor=b};this.setCellTextStyle=function(a,b,c){var d=this.dz(a);if(d){var f=d.childNodes[d.bq?d.bq[b]:b];if(f){var j="";this._hrrar&&this._hrrar[b]&&(j="display:none;");f.style.cssText=j+"width:"+f.style.width+";"+c}}};this.rn=function(a){var b=this.dz(a);if(b)b.style.fontWeight="normal"};this.aai=function(a){return this.dz(a)!=null? !0: !1};this.adG=function(){return this.gA};this.zs=function(a){var b=this.dz(a);if(this.gY())return this.MN(a,-1);var c=this.am.bP(b);if(b.previousSibling&&c!=0){b.parentNode.insertBefore(b,b.previousSibling);this.am.yk(c,c-1);this.setSizes();var d=this.aD.bP(b);this.aD.yk(d,d-1);this.hC&&this._fixAlterCss(c-1)}};this.uQ=function(a){var b=this.dz(a);if(this.gY())return this.MN(a,1);var c=this.am.bP(b);if(b.nextSibling){this.am.yk(c,c+1);b.nextSibling.nextSibling?b.parentNode.insertBefore(b,b.nextSibling.nextSibling):b.parentNode.appendChild(b);this.setSizes();var d=this.aD.bP(b);this.aD.yk(d,d+1);this.hC&&this._fixAlterCss(c)}};this.cf=function(a){this.combos[a]||(this.combos[a]=new dhtmlXGridComboObject);return this.combos[a]};this.setUserData=function(a,b,c){a||(a="gridglobaluserdata");this.bH[a]||(this.bH[a]=new qB);this.bH[a].eT(b,c)};this.getUserData=function(a,b){a||(a="gridglobaluserdata");this.dz(a);var c=this.bH[a];return c?c.get(b):""};this.setEditable=function(a){this.oB=ap(a)};this.selectRowById=function(a,b,c,d){d||(d= !1);this.eQ(this.dz(a),0,d,b,!1,c)};this.pL=function(){this.editStop();for(var a=0;a<this.bY.length;a++){var b=this.bj[this.bY[a].idd];if(b)b.className=b.className.replace(/rowselected/g,"")}this.bY=dhtmlxArray();this.row=null;if(this.cell!=null)this.cell.className=this.cell.className.replace(/cellselected/g,""),this.cell=null;this.callEvent("onSelectionCleared",[])};this.RK=function(a,b){var c=this.dz(a);if(this.gY())this.DF(c,a,b);else for(var d=0;d<c.cells.length;d++)this.cells(b,d).setValue(this.cells(a,d).getValue());if(!_isIE)this.dz(a).cells[0].height=c.cells[0].offsetHeight};this.setFooterLabel=function(a,b,c){return this.adA(a,b,c,this.ftr)};this.adA=function(a,b,c,d){var f=(d||this.hdr).rows[c||1],j=f.bq?f.bq[a]:a;if(f.cells[j]){if(this.pH){f.cells[j].style.textAlign="left";f.cells[j].innerHTML="<img src='"+this.eg+""+b+"' onerror='this.src = \""+this.eg+"imageloaderror.gif\"'>";var l=new Image;l.src=this.eg+""+b.replace(/(\.[a-z]+)/,".des$1");this.sf[this.sf.length]=l;var m=new Image;m.src=this.eg+""+b.replace(/(\.[a-z]+)/,".asc$1");this.sf[this.sf.length]=m}else{var k="<div class='hdrcell'>";if(b.indexOf("img:[")!= -1){var n=b.replace(/.*\[([^>]+)\].*/,"$1"),b=b.substr(b.indexOf("]")+1,b.length);k+="<img width='18px' height='18px' align='absmiddle' src='"+n+"' hspace='2'>"}k+=b;k+="</div>";f.cells[j].innerHTML=k;if(this.Oi[j])f.cells[j].style.cssText=this.Oi[j]}if((b||"").indexOf("#")!= -1){var o=b.match(/(^|{)#([^}]+)(}|$)/);if(o){var p="_in_header_"+o[2];if(this[p])this[p](this.qW?f.cells[j].firstChild:f.cells[j],j,b.split(o[0]))}}}};this.setColLabel=function(a,b,c,d){return this.adA(a,b,(c||0)+1,d)};this.clearAll=function(a){if(this.obj.rows[0]){if(this._h2&&(this._h2=new dhtmlxHierarchy,this.aC))this.nh?this._h2=this.aC._h2:this.aC._h2=this._h2;this.limit=this.LC=0;this.editStop(!0);this.ee&&window.clearTimeout(this.ee);if(this.ic)this.HF.scrollTop=0,this.limit=this.LC||0,this.CV= !0;for(var b=this.am.length,b=this.obj.rows.length,c=b-1;c>0;c--){var d=this.obj.rows[c];d.parentNode.removeChild(d)}if(a){this._master_row=null;this.obj.rows[0].parentNode.removeChild(this.obj.rows[0]);for(c=this.hdr.rows.length-1;c>=0;c--)d=this.hdr.rows[c],d.parentNode.removeChild(d);if(this.ftr)this.ftr.parentNode.removeChild(this.ftr),this.ftr=null;this._aHead=this.ftr=this.aoX=this._aFoot=null;this.cellType=dhtmlxArray();this._hrrar=[];this.columnIds=[];this.combos=[];this.dA=[];this.QL=[];this.Az=null}this.cell=this.row=null;this.am=dhtmlxArray();this.bj={};this.afF=[];this.aD=dhtmlxArray();this.bH=[];this.bY=dhtmlxArray();if(this.aW||this.ahK)this.tR="";this.aW&&this.changePage(1);this.Bf&&window.clearTimeout(this.Bf);this.agg&&this.enableStableSorting(!0);this._fillers=this.undefined;this.co(!1);this.setSizes();this.callEvent("onClearAll",[])}};this.adU=function(a,b,c){if(this.iD()==0)return!1;var d=this.hdr.rows[0].cells[a];if(d&&d.tagName=="TH"&&this.fldSort.length-1>=d._cellIndex&&this.fldSort[d._cellIndex]!="na"){var f=this.xu(),j=f[0]==a&&f[1]=="asc"?"des":"asc";if(this.callEvent("onBeforeSorting",[a,this.fldSort[a],j])){this.gB.src=this.eg+"sort_"+(j=="asc"?"asc":"desc")+".gif";if(this.pH){var l=this.hdr.rows[1].cells[d._cellIndex].firstChild;if(this.ij!=null){var m=this.hdr.rows[1].cells[this.ij._cellIndex].firstChild;m.src=m.src.replace(/(\.asc\.)|(\.des\.)/,".")}l.src=l.src.replace(/(\.[a-z]+)$/,"."+j+"$1")}this.xK(d._cellIndex,this.fldSort[d._cellIndex],j);this.ij=d;this.yH=c;var k=this.hdr.rows[1],k=c.parentNode,n=k.bq?k.bq[d._cellIndex]:d._cellIndex;this.vo(!1,!1,!1,c)}}};this.setCustomSorting=function(a,b){if(!this._customSorts)this._customSorts=[];this._customSorts[b]=typeof a=="string"?eval(a):a;this.fldSort[b]="cus"};this.enableHeaderImages=function(a){this.pH=a};this.setHeader=function(a,b,c){for(var d=typeof a!="object"?this.ZK(a):[].concat(a),f=[],j=new dhtmlxArray(0),l=[],m=[],k=[],n=0;n<d.length;n++)f[f.length]=Math.round(100/d.length),j[j.length]="ed",l[l.length]="left",m[m.length]="middle",k[k.length]="na";this.JP=b||"#cspan";this.hdrLabels=d;this.aoX=f;this.initCellWidth.length||this.setInitWidthsP(f.join(this.gX),!0);this.cellType=j;this.cellAlign=l;this.cellVAlign=m;this.fldSort=k;this.Oi=c||[]};this.ZK=function(a){if(![].push)return a.split(this.gX);var b="r"+(new Date).valueOf(),c=this.gX.replace(/([\|\+\*\^])/g,"\\$1");return(a||"").replace(RegExp(c,"g"),b).replace(RegExp("\\\\"+b,"g"),this.gX).split(b)};this.abv=function(a){return this.cellType[a]};this.aii=function(a){return this.cellType[this.getColIndexById(a)]};this.setColTypes=function(a){this.cellType=dhtmlxArray(a.split(this.gX));this.dA=[];for(var b=0;b<this.cellType.length;b++){if(this.cellType[b].indexOf("[")!= -1){var c=this.cellType[b].split(/[\[\]]+/g);this.cellType[b]=c[0];this.QL[b]=c[1];c[1].indexOf("=")==0&&(this.cellType[b]="math",this.dA[b]=c[0])}window["eXcell_"+this.cellType[b]]||dhtmlxError.gn("Configuration","Incorrect cell type: "+this.cellType[b],[this,this.cellType[b]])}};this.setColSorting=function(a){this.fldSort=a.split(this.gX);for(var b=0;b<this.fldSort.length;b++)if(this.fldSort[b].length>4&&typeof window[this.fldSort[b]]=="function"){if(!this._customSorts)this._customSorts=[];this._customSorts[b]=window[this.fldSort[b]];this.fldSort[b]="cus"}};this.setColAlign=function(a){this.cellAlign=a.split(this.gX);for(var b=0;b<this.cellAlign.length;b++)this.cellAlign[b]=this.cellAlign[b].PA()};this.setColVAlign=function(a){this.cellVAlign=a.split(this.gX)};this.setNoHeader=function(a){this.sB=ap(a)};this.aqG=function(a){this.dz(a);this._h2&&this.hx(this._h2.get[a].parent.id);for(var b=this.dz(a).childNodes[0];b&&b.style.display=="none";)b=b.nextSibling;b&&this.HZ(b,!0)};this.mp=function(a,b,c,d){this.Gz=[a,b,c,c,d];for(var f=["#"+this.aL.id+" table.hdr td","#"+this.aL.id+" table.obj td","#"+this.aL.id+" table.obj tr.rowselected td.cellselected","#"+this.aL.id+" table.obj td.cellselected","#"+this.aL.id+" table.obj tr.rowselected td"],j=0;!_isIE;){try{var l=document.styleSheets[j].cssRules.length}catch(m){j++;continue}break}for(var k=0;k<f.length;k++)this.Gz[k]&&(_isIE?document.styleSheets[0].addRule(f[k],this.Gz[k]):document.styleSheets[j].insertRule(f[k]+(" { "+this.Gz[k]+" }"),document.styleSheets[j].cssRules.length))};this.setColumnColor=function(a){this.columnColor=a.split(this.gX)};this.enableAlterCss=function(a,b,c,d){(a||b)&&this.attachEvent("onGridReconstructed",function(){this._fixAlterCss();this.aC&&this.aC._fixAlterCss()});this.Cw=c;this.Vh=d;this.hC=a;this.iI=b};this._fixAlterCss=function(a){if(this._h2&&(this.Cw||this.Vh))return this.ahx(a);if(this.hC||this.iI)for(var b=a=a||0,c=a;c<this.am.length;c++)if(this.am[c]&&this.am[c].style.display!="none")this.am[c].te?b=1:(this.am[c].className=this.am[c].className.indexOf("rowselected")!= -1?b%2==1?this.iI+" rowselected "+(this.am[c].Vn||""):this.hC+" rowselected "+(this.am[c].Vn||""):b%2==1?this.iI+" "+(this.am[c].Vn||""):this.hC+" "+(this.am[c].Vn||""),b++)};this.KQ=function(){for(var a=0;a<this.am.length;a++){var b=this.am[a];if(b&&b.childNodes)for(var c=b.childNodes.length,d=0;d<c;d++)b.childNodes[d].hy= !1}};this.Dk=function(a){var b=[];this.forEachRow(function(c){var d=this.bj[c];if(d.tagName=="TR"){var f=d.childNodes.length;if(a&&d.adM)b[b.length]=d.idd;else for(var j=0;j<f;j++)if(d.childNodes[j].hy){b[b.length]=d.idd;break}}});return b.join(this.gX)};this.Jr=this.Jb= !1;this.fu=function(a,b,c,d,f,j){this.Jb=a;this.Jr=b;this.Ld=c;this.Zx=d;this.xq=f;this.LB=j};this.pm=function(a){if(a){this.nF=(a||"").split(",");for(var b=0;b<this.nF.length;b++)this.nF[b]=ap(this.nF[b])}else this.nF=null};this.JS=function(){this.editStop();var a=[],b="</"+this.xml.yU+">";if(this.gY())this._h2.forEachChildF(0,function(b){var c=this.xO(this.render_row_tree(-1,b.id));a.push(c);return c? !0: !1},this,function(){a.push(b)});else for(var c=0;c<this.aD.length;c++)if(this.aD[c]&&(!this.Zx|| !this.aD[c]._locator)){var d=this.xO(this.render_row(c));a.push(d);d&&a.push(b)}return[a.join("")]};this.xO=function(a,b){var c=[],d=this.xml.row_attrs,f=this.xml.cell_attrs;c.push("<"+this.xml.yU);c.push(" id='"+a.idd+"'");this.Jr&&this.bY.bP(a)!= -1&&c.push(" selected='1'");this._h2&&this._h2.get[a.idd].state=="minus"&&c.push(" open='1'");if(d.length)for(b=0;b<d.length;b++)c.push(" "+d[b]+"='"+a._attrs[d[b]]+"'");c.push(">");if(this.Jb&&this.bH[a.idd]){vU=this.bH[a.idd].Ln();for(var j=0;j<vU.length;j++)c.push("<userdata name='"+vU[j]+"'>"+(this.LB?"<![CDATA[":"")+this.bH[a.idd].get(vU[j])+(this.LB?"]]\>":"")+"</userdata>")}for(var l= !1,m=0;m<this.gA;m++)if(!this.nF||this.nF[m]){var k=this.cells3(a,m);c.push("<cell");if(f.length)for(b=0;b<f.length;b++)c.push(" "+f[b]+"='"+k.cell._attrs[f[b]]+"'");wF=k[this.zt]();this.LB&&(wF="<![CDATA["+wF+"]]\>");this.CP&&k.cell.colSpan&&k.cell.colSpan>1&&c.push(' colspan="'+k.cell.colSpan+'" ');this.Zx?k.hy()&&(c.push(' changed="1"'),l= !0):this.xq&&k.hy()&&(l= !0);this.Jr&&this.cellType[m]=="tree"?c.push((this._h2?" image='"+this._h2.get[a.idd].image+"'":"")+">"+wF+"</cell>"):c.push(">"+wF+"</cell>");if(this.CP&&k.cell.colSpan)for(var n=0;n<k.cell.colSpan-1;n++)c.push("<cell/>"),m++}return this.xq&& !l&& !a.adM?"":c.join("")};this.Aj=function(){for(var a="<head>",b=0;b<this.hdr.rows[0].cells.length;b++)if(!this.nF||this.nF[b]){var c=this.fldSort[b];c=="cus"&&(c=this._customSorts[b].toString(),c=c.replace(/function[\ ]*/,"").replace(/\([^\f]*/,""));a+="<column width='"+this.yI(b)+"' align='"+this.cellAlign[b]+"' type='"+this.cellType[b]+"' sort='"+(c||"na")+"' color='"+this.columnColor[b]+"'"+(this.columnIds[b]?" id='"+this.columnIds[b]+"'":"")+">";a+=this.LB?"<![CDATA["+this.wW(b)+"]]\>":this.wW(b);var d=this.cf(b);if(d)for(var f=0;f<d.kk.length;f++)a+="<option value='"+d.kk[f]+"'>"+d.values[f]+"</option>";a+="</column>"}return a+="</head>"};this.serialize=function(){var a='<?xml version="1.0"?><rows>';this.zt=this.oX?"getMathValue":"getValue";if(this.Jb&&this.bH.gridglobaluserdata)for(var b=this.bH.gridglobaluserdata.Ln(),c=0;c<b.length;c++)a+="<userdata name='"+b[c]+"'>"+this.bH.gridglobaluserdata.get(b[c])+"</userdata>";this.Ld&&(a+=this.Aj());a+=this.JS();a+="</rows>";return a};this.fI=function(a,b){if(!b&& !_isChrome){var c=getOffset(a);return[c.left,c.top]}for(var b=b||document.body,d=a,f=0,j=0;d&&d!=b;)f+=d.offsetLeft-d.scrollLeft,j+=d.offsetTop-d.scrollTop,d=d.offsetParent;b==document.body&&(_isIE?(j+=document.body.offsetTop||document.documentElement.offsetTop,f+=document.body.offsetLeft||document.documentElement.offsetLeft):aq||(f+=document.body.offsetLeft,j+=document.body.offsetTop));return[f,j]};this.bw=function(a,b){for(;a&&a.tagName!=b&&a.tagName!="BODY";)a=a.parentNode;return a};this.HF.onscroll=function(){this.grid._doOnScroll()};this.kR.onscroll=function(){if(!this._try_header_sync){this._try_header_sync= !0;if(this.grid.HF.scrollLeft!=this.scrollLeft)this.grid.HF.scrollLeft=this.scrollLeft;this._try_header_sync= !1}};if(!cU||pe>8.5)this.hdr.onmousemove=function(a){this.grid.bX(a||window.event)},this.hdr.onmousedown=function(a){return this.grid.eJ(a||window.event)};this.obj.onmousemove=this.Xj;this.HF.onclick=function(a){(a||event).cancelBubble= !0};this.obj.onclick=function(a){this.grid.aV(a||window.event);this.grid.aU?this.grid.gh(a||window.event):this.grid.editStop();(a||event).cancelBubble= !0};gP?this.aL.oncontextmenu=function(a){a.cancelBubble= !0;a.returnValue= !1;return this.grid._doContClick(a||window.event)}:(this.aL.onmousedown=function(a){return this.grid._doContClick(a||window.event)},this.aL.oncontextmenu=function(a){if(this.grid.Gs)(a||event).cancelBubble= !0;return!this.grid.Gs});this.obj.ondblclick=function(a){if(!this.grid.gF(a||window.event))return!1;if(this.grid.aP){var b=this.grid.bw(_isIE?event.srcElement:a.target,"TR");b==this.grid.row&&this.grid.gh(a||window.event)}(a||event).cancelBubble= !0;if(cU)return!1};this.hdr.onclick=this.FJ;this.gB.onclick=function(){c.FJ.apply({grid:c},[null,c.yH])};this.hdr.ondblclick=this.LI;if(!document.body.FO)dhtmlxEvent(document,"keydown",function(a){if(globalActiveDHTMLGridObject)return globalActiveDHTMLGridObject.bQ(a||window.event)}),document.body.FO= !0;dhtmlxEvent(document.body,"click",function(){c.editStop&&c.editStop();c.ft&&c.setActive(!1)});this.aL.onbeforeactivate=function(){this.QX=null;this.grid.setActive();event.cancelBubble= !0};this.aL.onbeforedeactivate=function(){this.grid.QX?this.grid.QX=null:this.grid.ft= !1;event.cancelBubble= !0};if(this.aL.style.height.toString().indexOf("%")!= -1)this._delta_y=this.aL.style.height;if(this.aL.style.width.toString().indexOf("%")!= -1)this._delta_x=this.aL.style.width;(this._delta_x||this._delta_y)&&this.tZ();this.FM=this.abt;this.enableCollSpan=this.enableColSpan;this.Rn=this.enableMultiselect;this.CB=this.enableMultiline;this.iu=this.Yb;this.bI=this.acg;this.wW=this.adE;this.Xu=this.aai;this.So=this.adG;this.dX=this.selectRowById;this.Cs=this.adA;this.jJ=this.vq;this.enableAutoHeigth=this.enableAutoHeight;this.iH=this.uid;dhtmlx.image_path&&this.setImagePath(dhtmlx.image_path);dhtmlx.skin&&this.setSkin(dhtmlx.skin);return this};dhtmlXGridObject.prototype={getRowAttribute:function(a,b){return this.dz(a)._attrs[b]},setRowAttribute:function(a,b,c){this.dz(a)._attrs[b]=c},gY:function(){return this.cellType.bP("tree")!= -1},sO:function(a,b){var c=ap(b),d=this.dz(a);if(d){d.expand===""&&this.collapseKids(d);if(b&&d.style.display!="none"){d.style.display="none";var e=this.bY.bP(d);if(e!= -1){d.className=d.className.replace("rowselected","");for(var h=0;h<d.childNodes.length;h++)d.childNodes[h].className=d.childNodes[h].className.replace(/cellselected/g,"");this.bY.at(e)}this.callEvent("onGridReconstructed",[])}if(!b&&d.style.display=="none")d.style.display="",this.callEvent("onGridReconstructed",[]);this.callEvent("onRowHide",[a,b]);this.setSizes()}},setColumnHidden:function(a,b){if(!this.hdr.rows.length){if(!this.Az)this.Az=[];return this.Az[a]=b}if(this.ij&&this.ij.cellIndex==a&&b)this.gB.style.display="none";var c=ap(b);if(c){if(this._hrrar){if(this._hrrar[a])return}else this._hrrar=[];this._hrrar[a]="display:none;";this.wx(a,"none")}else{if(!this._hrrar|| !this._hrrar[a])return;this._hrrar[a]="";this.wx(a,"")}if(this.ij&&this.ij.cellIndex==a&& !b)this.gB.style.display="inline";this.vo();this.callEvent("onColumnHidden",[a,b])},Fs:function(a){return this._hrrar&&this._hrrar[a]? !0: !1},abt:function(a){if(a)this.Az=a.split(this.gX);if(this.hdr.rows.length&&this.Az)for(var b=0;b<this.Az.length;b++)this.setColumnHidden(b,this.Az[b])},pM:function(a,b,c,d,e){for(var e=e||"_cellIndex",h=a.rows.length,i=0;i<h;i++){var g=a.rows[i].childNodes;if(g.length!=this.gA)for(var f=0;f<g.length;f++){if(g[f][e]==b){g[f].style[c]=d;break}}else g[b].style[c]=d}},wx:function(a,b){var c=a;this.hdr.rows[1]&&this.hdr.rows[1].bq&&this.hdr.rows[1].bq[a]!=a&&(c=this.hdr.rows[1].bq[a]);if(b=="none"){this.hdr.rows[0].cells[a].uE=this.hdr.rows[0].cells[a].style.width||this.initCellWidth[a]+"px";this.hdr.rows[0].cells[a].Ce=this.cellWidthPC[a];this.obj.rows[0].cells[a].style.width="0px";var d={rows:[this.obj.rows[0]]};this.forEachRow(function(a){this.bj[a].tagName=="TR"&&d.rows.push(this.bj[a])});this.pM(d,a,"display","none");this.gY()&&this.oj(a,"none");(cU&&pe<9||cn||aq)&&this.pM(this.hdr,a,"display","none","_cellIndexS");this.ftr&&this.pM(this.ftr.childNodes[0],a,"display","none");this.pM(this.hdr,a,"whiteSpace","nowrap","_cellIndexS");if(!this.cellWidthPX.length&& !this.cellWidthPC.length)this.cellWidthPX=[].concat(this.initCellWidth);this.cellWidthPX[a]&&(this.cellWidthPX[a]=0);this.cellWidthPC[a]&&(this.cellWidthPC[a]=0)}else if(this.hdr.rows[0].cells[a].uE){var e=this.hdr.rows[0].cells[a];(cU||cn||aq)&&this.pM(this.hdr,a,"display","","_cellIndexS");this.ftr&&this.pM(this.ftr.childNodes[0],a,"display","");d={rows:[this.obj.rows[0]]};this.forEachRow(function(a){this.bj[a].tagName=="TR"&&d.rows.push(this.bj[a])});this.pM(d,a,"display","");this.gY()&&this.oj(a,"");this.pM(this.hdr,a,"whiteSpace","normal","_cellIndexS");if(e.Ce)this.cellWidthPC[a]=e.Ce;e.uE&&(this.cellWidthPX[a]=parseInt(e.uE))}this.setSizes();if(!_isIE&& !aq)this.obj.border=1,this.obj.border=0},enableColSpan:function(a){this.CP=ap(a)},enableRowsHover:function(a,b){this.Rz(!1,!0);this.Lk=b;if(ap(a)){if(!this.Qh)this.obj.Io=this.obj.onmousemove,this.obj.onmousemove=this.ff,_isIE?this.obj.onmouseleave=this.Rz:this.obj.onmouseout=this.Rz,this.Qh= !0}else if(this.Qh)this.obj.onmousemove=this.obj.Io,_isIE?this.obj.onmouseleave=null:this.obj.onmouseout=null,this.Qh= !1},rg:function(a,b,c){this.aU=ap(a);this.aP=ap(b);this.UB=ap(c)},enableLightMouseNavigation:function(a){if(ap(a)){if(!this.UJ)this.aL.age=this.aL.onclick,this.aL.onclick=function(){return!0},this.obj.age=this.obj.onclick,this.obj.onclick=function(a){var c=this.grid.bw(a?a.target:event.srcElement,"TD");if(c)this.grid.editStop(),this.grid.doClick(c),this.grid.gh(),(a||event).cancelBubble= !0},this.obj.KA=this.obj.onmousemove,this.obj.onmousemove=this.Oy,this.UJ= !0}else if(this.UJ)this.aL.onclick=this.aL.age,this.obj.onclick=this.obj.age,this.obj.onmousemove=this.obj.KA,this.UJ= !1},Rz:function(a,b){that=b?this:this.grid;if(that.Fr&&that.Fr!=b){for(var c=0;c<that.Fr.childNodes.length;c++)that.Fr.childNodes[c].className=that.Fr.childNodes[c].className.replace(that.Lk,"");that.Fr=null}},ff:function(a){var b=this.grid.bw(a?a.target:event.srcElement,"TD");if(b&&b.parentNode!=this.grid.Fr){this.grid.Rz(0,b);b=b.parentNode;if(!b.idd||b.idd=="__filler__")return;for(var c=0;c<b.childNodes.length;c++)b.childNodes[c].className+=" "+this.grid.Lk;this.grid.Fr=b}this.Io(a)},Oy:function(a){if(!this.grid.editor){var b=this.grid.bw(a?a.target:event.srcElement,"TD");b.parentNode.idd&&this.grid.doClick(b,!0,0)}this.KA(a)},enableDistributedParsing:function(a,b,c){ap(a)?(this.Hv=b||10,this.Kb=c||250):this.Hv=0},fA:function(){this.editStop(!0);if(this.zY)this.zY=window.clearTimeout(this.zY);this.aL.className=(this.aL.className||"").replace(/gridbox.*/,"");if(this.vn)for(var a=0;a<this.vn.length;a++)this.qs.removeChild(this.vn[a]);var b;this.bA=this.bA.fA();for(a=0;a<this.am.length;a++)if(this.am[a])this.am[a].grid=null;for(a in this.bj)this.bj[a]&&(this.bj[a]=null);this.am=new dhtmlxArray;this.bj={};this.aL.innerHTML="";var c=function(){};this.setSizes=this._update_srnd_view=this.callEvent=this.aL.onclick=this.aL.onmousedown=this.aL.onbeforeactivate=this.aL.onbeforedeactivate=this.aL.onbeforedeactivate=this.aL.onselectstart=c;this.aL.grid=this.HF.grid=this.kR.grid=this.obj.grid=this.hdr.grid=null;if(this.aC)this.globalBox.innerHTML="",this.aC.setSizes=this.aC._update_srnd_view=this.aC.callEvent=c,this.globalBox.onclick=this.globalBox.onmousedown=this.globalBox.onbeforeactivate=this.globalBox.onbeforedeactivate=this.globalBox.onbeforedeactivate=this.globalBox.onselectstart=c;for(b in this){if(this[b]&&this[b].yO)this[b].yO=null;this[b]=null}this==globalActiveDHTMLGridObject&&(globalActiveDHTMLGridObject=null);return null},xu:function(){var a=[];if(this.ij)a[0]=this.ij._cellIndex,a[1]=this.gB.src.indexOf("sort_desc.gif")!= -1?"des":"asc";return a},enableAutoHeight:function(a,b,c){this.abK=ap(a);this.aea=ap(c);this.FF=b||null;if(arguments.length==1)this.HF.style.overflowY=a?"hidden":"auto";if(b=="auto")this.FF=null,this.aic= !0,this.tZ()},enableStableSorting:function(a){this.agg=ap(a);this.am.stablesort=function(a){for(var c=this.length-1,d=0;d<this.length-1;d++){for(var e=0;e<c;e++)if(a(this[e],this[e+1])>0){var h=this[e];this[e]=this[e+1];this[e+1]=h}c--}}},enableKeyboardSupport:function(a){this.Zl= !ap(a)},enableContextMenu:function(a){this.Gs=a},Tk:function(){},aja:function(a){this.FB=a.split(",");for(var b=0;b<this.FB.length;b++)this.FB[b]=ap(this.FB[b])},aik:function(a){this.qZ=a.split(",");for(var b=0;b<this.qZ.length;b++)this.qZ[b]=ap(this.qZ[b])},mE:function(a,b){if(arguments.length==2){if(!this._drsclmW)this._drsclmW=[];this._drsclmW[b]=a}else this._drsclmW=a.split(",")},enableCellIds:function(a){this.ajm=ap(a)},ty:function(a,b){var c=this.dz(a);if(c)c.FG=ap(b),this.cell&&this.cell.parentNode.idd==a&&this.editStop()},Vf:function(a){for(var b=[],c=0;c<a.childNodes.length;c++){var d=this.cells3(a,c);b[c]=d.getValue()}return b},setDateFormat:function(a,b){this.RY=a;this._dtmask_inc=b},kr:function(a,b,c,d){var e=a.replace(/[^0\,\.]*/g,""),h=e.indexOf(".");h> -1&&(h=e.length-h-1);var i=e.indexOf(",");i> -1&&(i=e.length-h-2-i);if(typeof c!="string")c=this.i18n.decimal_separator;if(typeof d!="string")d=this.i18n.group_separator;var g=a.split(e)[0],f=a.split(e)[1];this._maskArr[b]=[h,i,g,f,c,d]},Sl:function(a,b){var c=this._maskArr[b];if(!c)return a;var d=parseFloat(a.toString().replace(/[^0-9]*/g,""));a.toString().substr(0,1)=="-"&&(d*= -1);c[0]>0&&(d/=Math.pow(10,c[0]));return d},PH:function(a,b){var c=this._maskArr[b];if(!c)return a;var d=(parseFloat(a)<0?"-":"")+c[2],a=Math.abs(Math.round(parseFloat(a)*Math.pow(10,c[0]>0?c[0]:0))).toString(),a=(a.length<c[0]?Math.pow(10,c[0]+1-a.length).toString().substr(1,c[0]+1)+a.toString():a).split("").reverse();a[c[0]]=(a[c[0]]||"0")+c[4];if(c[1]>0)for(var e=(c[0]>0?0:1)+c[0]+c[1];e<a.length;e+=c[1])a[e]+=c[5];return d+a.reverse().join("")+c[3]},DV:function(a){for(var b=0;b<a.length;b++){for(var c=[],d=0;d<a[b].childNodes.length;d++)if(a[b].childNodes[d].nodeType==1)c[c.length]=a[b].childNodes[d].firstChild.data;this[a[b].getAttribute("command")].apply(this,c)}},Ov:function(a){var b=this.bA.et("./head",a);if(b.length){var c=this.bA.et("./column",b[0]),d=this.bA.et("./settings",b[0]),e="setInitWidths",h= !1;if(d[0])for(var i=0;i<d[0].childNodes.length;i++)switch(d[0].childNodes[i].tagName){case "colwidth":d[0].childNodes[i].firstChild&&d[0].childNodes[i].firstChild.data=="%"&&(e="setInitWidthsP");break;case "splitat":h=d[0].childNodes[i].firstChild?d[0].childNodes[i].firstChild.data: !1}this.DV(this.bA.et("./beforeInit/call",b[0]));if(c.length>0){this.hdr.rows.length>0&&this.clearAll(!0);for(var g=[[],[],[],[],[],[],[],[],[]],f=",width,type,align,sort,color,format,hidden,id".split(","),j=["",e,"setColTypes","setColAlign","setColSorting","setColumnColor","","","setColumnIds"],l=0;l<c.length;l++){for(var m=1;m<f.length;m++)g[m].push(c[l].getAttribute(f[m]));g[0].push((c[l].firstChild?c[l].firstChild.data:"").replace(/^\s*((\s\S)*.+)\s*$/gi,"$1"))}this.setHeader(g[0]);for(l=0;l<j.length;l++)if(j[l])this[j[l]](g[l].join(this.gX));for(l=0;l<c.length;l++)if(this.cellType[l].indexOf("co")==0||this.cellType[l]=="clist"){var k=this.bA.et("./option",c[l]);if(k.length){var n=[];if(this.cellType[l]=="clist"){for(m=0;m<k.length;m++)n[n.length]=k[m].firstChild?k[m].firstChild.data:"";this.AO(l,n)}else for(var o=this.cf(l),m=0;m<k.length;m++)o.eT(k[m].getAttribute("value"),k[m].firstChild?k[m].firstChild.data:"")}}else g[6][l]&&(this.cellType[l].toLowerCase().indexOf("calendar")!= -1||this.fldSort[l]=="date"?this.setDateFormat(g[6][l]):this.kr(g[6][l],l));this.init();var p=g[7].join(this.gX);this.FM&&p.replace(/,/g,"")!=""&&this.FM(p);h&&this.tT&&this.tT(h)}this.DV(this.bA.et("./afterInit/call",b[0]))}var r=this.bA.et("//rows/userdata",a);if(r.length>0){this.bH.gridglobaluserdata||(this.bH.gridglobaluserdata=new qB);for(m=0;m<r.length;m++){for(var s="",t=0;t<r[m].childNodes.length;t++)s+=r[m].childNodes[t].nodeValue;this.bH.gridglobaluserdata.eT(r[m].getAttribute("name"),s)}}},aiZ:function(a){var b=[];this.forEachRowA(function(c){this.cells(c,a).getValue()!=0&&b.push(c)},!0);return b.join(",")},checkAll:function(){for(var a=arguments.length?arguments[0]:1,b=0;b<this.adG();b++)this.abv(b)=="ch"&&this.setCheckedRows(b,a)},uncheckAll:function(){this.checkAll(0)},setCheckedRows:function(a,b){this.forEachRowA(function(c){this.cells(c,a).wI()&&this.cells(c,a).setValue(b)})},Xj:function(a){var b=this.grid.bw(a?a.target:event.srcElement,"TD");if(!b||this.grid.editor&&this.grid.editor.cell==b)return!0;var c=b.parentNode;if(c.idd&&c.idd!="__filler__"){var d=a?a.target:event.srcElement;if(c.idd==window.unknown)return!0;if(!this.grid.callEvent("onMouseOver",[c.idd,b._cellIndex,a||window.event]))return!0;if(this.grid.FB&& !this.grid.FB[b._cellIndex]){if(d.title)d.title="";return!0}if(!(b._cellIndex>=this.grid.gA)){var e=this.grid.cells3(c,b._cellIndex);if(e&&e.cell&&e.cell._attrs){if(d.ahi)e.cell.title="";if(!e.cell._attrs.title)d.ahi= !0;if(e)d.title=e.cell._attrs.title||(e.getTitle?e.getTitle():(e.getValue()||"").toString().replace(/<[^>]*>/gi,""));return!0}}}},UH:function(a){if(aq)this.Wr=parseInt(a)},aau:function(a){for(var b=[],c=0;c<this.aD.length;c++)this.aD[c]&&b.push(this.aD[c].idd);return b.join(a||this.gX)},Iy:function(){return this.aau()},Oq:function(a,b,c){if(this.CP){var d=this.dz(a);if(d.bq&&d.childNodes[d.bq[b]]){var e=d.bq[b],h=d.childNodes[e],i=h.colSpan;h.colSpan=1;if(i&&i!=1)for(var g=1;g<i;g++){var f=document.createElement("TD");h.nextSibling?d.insertBefore(f,h.nextSibling):d.appendChild(f);d.bq[b+g]=e+g;f._cellIndex=b+g;f.style.textAlign=this.cellAlign[g];f.style.verticalAlign=this.cellVAlign[g];h=f;this.cells3(d,b+g).setValue("")}for(var j=b*1+1*i;j<d.bq.length;j++)d.bq[j]+=(i-1)*1}if(c&&c>1){if(d.bq)e=d.bq[b];else{e=b;d.bq=[];for(j=0;j<d.childNodes.length;j++)d.bq[j]=j}d.childNodes[e].colSpan=c;for(j=1;j<c;j++)d.bq[d.childNodes[e+1]._cellIndex]=e,d.removeChild(d.childNodes[e+1]);for(var l=d.childNodes[d.bq[b]]._cellIndex,j=l*1+1*c;j<d.bq.length;j++)d.bq[j]-=c-1}}},vq:function(a){this.ir=ap(a);this.bA.hN=this.ir},HG:function(a){this.anu=ap(a)},LI:function(a){var b=this.grid,c=b.bw(_isIE?event.srcElement:a.target,"TD");if(!b.anu)return!1;b.nT(c._cellIndexS)},nT:function(a,b){if(!this._hrrar|| !this._hrrar[a]){this.Hc= !0;var c=0;this.si(a,20);for(var d=1;d<this.hdr.rows.length;d++){var e=this.hdr.rows[d];if((e=e.childNodes[e.bq?e.bq[a]:a])&&(!e.colSpan||e.colSpan<2)&&e._cellIndex==a)e.childNodes[0]&&e.childNodes[0].className=="hdrcell"&&(e=e.childNodes[0]),c=Math.max(c,aq||cU?e.textContent.length*this.fontWidth:e.scrollWidth)}for(var h=this.obj.rows.length,i=1;i<h;i++){var g=this.obj.rows[i];this.bj[g.idd]&& !(g.bq&&g.bq[a]!=a)&&g.childNodes[a]&&(g=aq||cU||b?g.childNodes[a].textContent.length*this.fontWidth:g.childNodes[a].scrollWidth,g>c&&(c=g))}c+=20+(b||0);this.si(a,c);this.Hc= !1;this.setSizes()}},gz:function(a,b){var b=b||this.hdr,c=b.rows[a+1];c&&c.parentNode.removeChild(c);this.setSizes()},iS:function(a){this.gz(a,this.ftr)},attachHeader:function(a,b,c){typeof a=="string"&&(a=this.ZK(a));typeof b=="string"&&(b=b.split(this.gX));c=c||"_aHead";if(this.hdr.rows.length)if(a)this.Yw([a,b],this[c=="_aHead"?"hdr":"ftr"]);else{if(this[c])for(var d=0;d<this[c].length;d++)this.attachHeader.apply(this,this[c][d])}else this[c]||(this[c]=[]),this[c][this[c].length]=[a,b,c]},Yw:function(a,b){if(!b){if(this.aL.style.position!="absolute")this.aL.style.position="relative";var c=document.createElement("DIV");c.className="ftr";this.aL.appendChild(c);var d=document.createElement("TABLE");d.cellPadding=d.cellSpacing=0;if(!_isIE||_isIE==8)d.width="100%",d.style.paddingRight="20px";d.style.marginRight="20px";d.style.tableLayout="fixed";c.appendChild(d);d.appendChild(document.createElement("TBODY"));this.ftr=b=d;for(var e=d.insertRow(0),h=this.hdrLabels.length<=1?a[0].length:this.hdrLabels.length,i=0;i<h;i++)e.appendChild(document.createElement("TH")),e.childNodes[i]._cellIndex=i;_isIE&&_isIE<8?e.style.position="absolute":e.style.height="auto"}var g=a[1],c=document.createElement("TR");b.rows[0].parentNode.appendChild(c);for(i=0;i<a[0].length;i++)if(a[0][i]=="#cspan"){var f=c.cells[c.cells.length-1];f.colSpan=(f.colSpan||1)+1}else if(a[0][i]=="#rspan"&&b.rows.length>1){for(var j=b.rows.length-2,l= !1,f=null;!l;){for(var f=b.rows[j],m=0;m<f.cells.length;m++)if(f.cells[m]._cellIndex==i){l=m+1;break}j--}f=f.cells[l-1];f.rowSpan=(f.rowSpan||1)+1}else{var k=document.createElement("TD");k._cellIndex=k._cellIndexS=i;if(this._hrrar&&this._hrrar[i]&& !_isIE)k.style.display="none";if(typeof a[0][i]=="object")k.appendChild(a[0][i]);else if(k.innerHTML=this.qW?"<div class='hdrcell'>"+(a[0][i]||"&nbsp;")+"</div>":a[0][i]||"&nbsp;",(a[0][i]||"").indexOf("#")!= -1)if(d=a[0][i].match(/(^|{)#([^}]+)(}|$)/)){var n="_in_header_"+d[2];if(this[n])this[n](this.qW?k.firstChild:k,i,a[0][i].split(d[0]))}if(g)k.style.cssText=g[i];c.appendChild(k)}var o=b;if(cn)b.Ze&&window.clearTimeout(b.Ze),b.Ze=window.setTimeout(function(){b.rows[1].style.display="none";window.setTimeout(function(){b.rows[1].style.display=""},1)},500)},attachFooter:function(a,b){this.attachHeader(a,b,"_aFoot")},Me:function(a,b,c){this.tW(this.dz(a),b,c)},tW:function(a,b,c){var c=c||this.cellType[b],d=this.cells3(a,b),e=d.getValue();d.cell.zk=c;d=this.cells3(a,b);d.setValue(e)},CX:function(a,b){for(var c=this.bj[a],d=0;d<c.childNodes.length;d++)this.tW(c,d,b)},IP:function(a,b){for(var c=0;c<this.aD.length;c++)this.aD[c]&&this.aD[c].tagName=="TR"&&this.tW(this.aD[c],a,b);this.cellType[a]=="math"?this.dA[c]=b:this.cellType[a]=b},forEachRow:function(a){for(var b in this.bj)this.bj[b]&&this.bj[b].idd&&a.apply(this,[this.bj[b].idd])},forEachRowA:function(a){for(var b=0;b<this.aD.length;b++)this.aD[b]&&a.call(this,this.render_row(b).idd)},amz:function(a,b){var c=this.dz(a);if(c)for(var d=0;d<this.gA;d++)b(this.cells3(c,d),d)},enableAutoWidth:function(a,b,c){this.Gd=[ap(a),parseInt(b||99999),parseInt(c||0)];if(arguments.length==1)this.HF.style.overflowX=a?"hidden":"auto"},TJ:function(a,b,c,d){typeof b=="undefined"&&(b= !0);this.cZ=[!0,b,c];this.load(a,d)},OR:function(a){this._f_rowsBuffer&&this.GF(0,"");reset= !1;if(window.eXcell_tree)eXcell_tree.prototype.Tw=eXcell_tree.prototype.setValue,eXcell_tree.prototype.setValue=function(a){var b=this.grid._h2.get[this.cell.parentNode.idd];b&&this.cell.parentNode.JT?this.setLabel(a):this.Tw(a)};var b=this.cellType.bP("tree");a.cR("rows");var c=a.et("//rows")[0].getAttribute("parent")||0,d={};this.cZ[2]&&(b!= -1?this._h2.so(c,function(a){d[a.id]= !0},this):this.forEachRow(function(a){d[a]= !0}));for(var e=a.et("//row"),h=0;h<e.length;h++){var i=e[h],g=i.getAttribute("id");d[g]= !1;c=i.parentNode.getAttribute("id")||c;if(this.bj[g]&&this.bj[g].tagName!="TR")this._h2?this._h2.get[g].buff.data=i:this.aD[this.getRowIndex(g)].data=i,this.bj[g]=i;else if(this.bj[g])this._process_xml_row(this.bj[g],i,-1),this.jQ(this.bj[g],!0);else if(this.cZ[1]){var f={idd:g,data:i,_parser:this._process_xml_row,_locator:this._get_xml_data},j=this.aD.length;this.cZ[1]=="top"?(this.aD.unshift(f),j=0):this.aD.push(f);if(this._h2)reset= !0,this._h2.add(g,i.parentNode.getAttribute("id")||i.parentNode.getAttribute("parent")).buff=this.aD[this.aD.length-1];this.bj[g]=i;i=this.render_row(j);this._insertRowAt(i,j? -1:0)}}if(this.cZ[2])for(g in d)d[g]&&this.bj[g]&&this.deleteRow(g);this.cZ=null;if(window.eXcell_tree)eXcell_tree.prototype.setValue=eXcell_tree.prototype.Tw;reset&&this.uR();if(this._f_rowsBuffer)this._f_rowsBuffer=null,this.EJ()},getCustomCombo:function(a,b){var c=this.cells(a,b).cell;if(!c._combo)c._combo=new dhtmlXGridComboObject;return c._combo},aaK:function(a){var b=a.split(this.gX);this.Wq=[];for(var c=this.gA||a.length,d=0;d<c;d++)b[d]={c:parseInt(b[d]),ind:d};b.sort(function(a,b){return a.c>b.c?1: -1});for(d=0;d<c;d++)this.Wq[b[d].ind]= !b[d+1]||typeof b[d].c=="undefined"?(b[0].ind+1)* -1:b[d+1].ind},i18n:{loading:"Loading",decimal_separator:".",group_separator:","},zf:{k13_1_0:function(){var a=this.am.bP(this.row);this.eQ(this.am[a+1],this.cell._cellIndex,!0)},k13_0_1:function(){var a=this.am.bP(this.row);this.eQ(this.am[a-1],this.cell._cellIndex,!0)},k13_0_0:function(){this.editStop();this.callEvent("onEnter",[this.row?this.row.idd:null,this.cell?this.cell._cellIndex:null]);this.QX= !0},k9_0_0:function(){this.editStop();if(!this.callEvent("onTab",[!0]))return!0;var a=this.Kn(null,1);if(a)this.eQ(a.parentNode,a._cellIndex,this.row!=a.parentNode,!1,!0),this.QX= !0},k9_0_1:function(){this.editStop();if(!this.callEvent("onTab",[!1]))return!1;var a=this.Kn(null,-1);if(a)this.eQ(a.parentNode,a._cellIndex,this.row!=a.parentNode,!1,!0),this.QX= !0},k113_0_0:function(){this.UB&&this.gh()},k32_0_0:function(){var a=this.cells4(this.cell);if(!a.changeState||a.changeState()=== !1)return!1},k27_0_0:function(){this.editStop(!0)},k33_0_0:function(){this.aW?this.changePage(this.ew-1):this.PP(-1)},k34_0_0:function(){this.aW?this.changePage(this.ew+1):this.PP(1)},k37_0_0:function(){if(!this.editor&&this.gY())this.collapseKids(this.row);else return!1},k39_0_0:function(){if(!this.editor&&this.gY())this.expandKids(this.row);else return!1},k40_0_0:function(){var a=this.nh?this.aC:this;if(this.editor&&this.editor.combo)this.editor.eW();else{if(!this.row.idd)return;var b=Math.max(a._r_select||0,this.getRowIndex(this.row.idd))+1;if(this.aD[b])a._r_select=null,this.eQ(b,this.cell._cellIndex,!0),a.aW&&a.aqG(a.bB(b));else{if(!this.callEvent("onLastRow",[]))return!1;this.zf.k34_0_0.apply(this,[]);this.aW&&this.am[b]&&this.eQ(b,0,!0)}}this.QX= !0},k38_0_0:function(){var a=this.nh?this.aC:this;if(this.editor&&this.editor.combo)this.editor.Kc();else{if(!this.row.idd)return;var b=this.getRowIndex(this.row.idd)+1;if(b!= -1&&(!this.aW||b!=1)){var c=this.CE(b-1,-1);this.eQ(c,this.cell._cellIndex,!0);a.aW&&c&&a.aqG(c.idd)}else this.zf.k33_0_0.apply(this,[])}this.QX= !0}},_build_master_row:function(){for(var a=document.createElement("DIV"),b=["<table><tr>"],c=0;c<this.gA;c++)b.push("<td></td>");b.push("</tr></table>");a.innerHTML=b.join("");this._master_row=a.firstChild.rows[0]},uO:function(a){this._master_row||this._build_master_row();for(var b=this._master_row.cloneNode(!0),c=0;c<b.childNodes.length;c++){b.childNodes[c]._cellIndex=c;if(this.ajm)b.childNodes[c].id="c_"+a+"_"+c;this.nz&&this.ae.dS(b.childNodes[c],this)}b.idd=a;b.grid=this;return b},_process_jsarray_row:function(a,b){a._attrs={};for(var c=0;c<a.childNodes.length;c++)a.childNodes[c]._attrs={};this.VQ(a,this._c_order?this.Xb(b):b);return a},_get_jsarray_data:function(a,b){return a[b]},_process_json_row:function(a,b){b=this._c_order?this.Xb(b.data):b.data;return this._process_some_row(a,b)},_process_some_row:function(a,b){a._attrs={};for(var c=0;c<a.childNodes.length;c++)a.childNodes[c]._attrs={};this.VQ(a,b);return a},_get_json_data:function(a,b){return a.data[b]},_process_js_row:function(a,b){for(var c=[],d=0;d<this.columnIds.length;d++)c[d]=b[this.columnIds[d]],!c[d]&&c[d]!==0&&(c[d]="");this._process_some_row(a,c);a._attrs=b;return a},_get_js_data:function(a,b){return a[this.columnIds[b]]},_process_csv_row:function(a,b){a._attrs={};for(var c=0;c<a.childNodes.length;c++)a.childNodes[c]._attrs={};this.VQ(a,this._c_order?this.Xb(b.split(this.csv.cell)):b.split(this.csv.cell));return a},_get_csv_data:function(a,b){return a.split(this.csv.cell)[b]},_process_store_row:function(a,b){for(var c=[],d=0;d<this.columnIds.length;d++)c[d]=b[this.columnIds[d]];for(var e=0;e<a.childNodes.length;e++)a.childNodes[e]._attrs={};a._attrs=b;this.VQ(a,c)},_process_xml_row:function(a,b){var c=this.bA.et(this.xml.cell,b),d=[];a._attrs=this._xml_attrs(b);if(this._ud_enabled)for(var e=this.bA.et("./userdata",b),h=e.length-1;h>=0;h--){for(var i="",g=0;g<e[h].childNodes.length;g++)i+=e[h].childNodes[g].nodeValue;this.setUserData(a.idd,e[h].getAttribute("name"),i)}for(g=0;g<c.length;g++){var f=c[this._c_order?this._c_order[g]:g];if(f){var j=a.bq?a.bq[g]:g,l=f.getAttribute("type");if(a.childNodes[j]){if(l)a.childNodes[j].zk=l;a.childNodes[j]._attrs=this._xml_attrs(f)}f.getAttribute("xmlcontent")||(f=f.firstChild?f.firstChild.data:"");d.push(f)}}for(;g<a.childNodes.length;g++)a.childNodes[g]._attrs={};a.parentNode&&a.parentNode.tagName=="row"&&(a._attrs.parent=a.parentNode.getAttribute("idd"));this.VQ(a,d);return a},_get_xml_data:function(a,b){for(a=a.firstChild;;){if(!a)return "";a.tagName=="cell"&&b--;if(b<0)break;a=a.nextSibling}return a.firstChild?a.firstChild.data:""},VQ:function(a,b){this.editor&&this.editStop();for(var c=0;c<a.childNodes.length;c++)if(c<b.length||this.QL[c]){var d=a.childNodes[c]._cellIndex,e=b[d],h=this.cells4(a.childNodes[c]);if(this.QL[d]&&(e==""||typeof e=="undefined"))e=this.QL[d];h&&h.setValue(e)}else a.childNodes[c].innerHTML="&nbsp;",a.childNodes[c].mG= !0;return a},jQ:function(a,b){if(a._attrs["class"])a.Vn=a.className=a._attrs["class"];if(a._attrs.locked)a.FG= !0;if(a._attrs.bgColor)a.bgColor=a._attrs.bgColor;for(var c=0,d=0;d<a.childNodes.length;d++){var e=a.childNodes[d],h=e._cellIndex,i=e._attrs.style||a._attrs.style;i&&(e.style.cssText+=";"+i);if(e._attrs["class"])e.className=e._attrs["class"];if(i=e._attrs.align||this.cellAlign[h])e.align=i;e.vAlign=e._attrs.valign||this.cellVAlign[h];var g=e._attrs.bgColor||this.columnColor[h];if(g)e.bgColor=g;e._attrs.colspan&& !b&&(this.Oq(a.idd,d+c,e._attrs.colspan),c+=e._attrs.colspan-1);if(this._hrrar&&this._hrrar[h]&& !b)e.style.display="none"}this.callEvent("onRowCreated",[a.idd,a,null])},load:function(a,b,c){this.callEvent("onXLS",[this]);arguments.length==2&&typeof b!="function"&&(c=b,b=null);c=c||"xml";if(!this.tR)this.tR=a;this._data_type=c;this.bA.UR=function(a,e,h,i,g){a.callEvent&&(g=a["_process_"+c](g),a.Bf||a.callEvent("onXLE",[a,0,0,g]),b&&(b(),b=null))};this.bA.loadXML(a)},loadXMLString:function(a,b){var c=new ag(function(){});c.loadXMLString(a);this.parse(c,b,"xml")},loadXML:function(a,b){this.load(a,b,"xml")},parse:function(a,b,c){arguments.length==2&&typeof b!="function"&&(c=b,b=null);this._data_type=c=c||"xml";a=this["_process_"+c](a);this.Bf||this.callEvent("onXLE",[this,0,0,a]);b&&b()},xml:{top:"rows",row:"./row",cell:"./cell",yU:"row",s_cell:"cell",row_attrs:[],cell_attrs:[]},csv:{row:"\n",cell:","},_xml_attrs:function(a){var b={};if(a.attributes.length)for(var c=0;c<a.attributes.length;c++)b[a.attributes[c].name]=a.attributes[c].value;return b},_process_xml:function(a){if(!a.et){var b=new ag(function(){});typeof a=="string"?b.loadXMLString(a):(b.ai=a.responseXML?a:{},b.ai.responseXML=a);a=b}if(this.cZ)return this.OR(a);this._parsing= !0;var c=a.cR(this.xml.top);if(c.tagName==this.xml.top){var d=c.getAttribute("dhx_security");if(d)dhtmlx.security_key=d;this.Ov(c);var e=a.et(this.xml.row,c),h=parseInt(a.et("//"+this.xml.top)[0].getAttribute("pos")||0),i=parseInt(a.et("//"+this.xml.top)[0].getAttribute("total_count")||0),g= !1;i&&i!=this.aD.length&&(this.aD[i-1]||(this.aD.length&&(g= !0),this.aD[i-1]=null),i<this.aD.length&&(this.aD.splice(i,this.aD.length-i),g= !0));if(this.gY())return this._process_tree_xml(a);for(var f=0;f<e.length;f++)if(!this.aD[f+h]){var j=e[f].getAttribute("id")||f+h+1;this.aD[f+h]={idd:j,data:e[f],_parser:this._process_xml_row,_locator:this._get_xml_data};this.bj[j]=e[f]}if(g&&this.ahK){var l=this.HF.scrollTop;this._reset_view();this.HF.scrollTop=l}else this.render_dataset();this._parsing= !1;return a.ai.responseXML?a.ai.responseXML:a.ai}},_process_jsarray:function(a){this._parsing= !0;if(a&&a.ai)eval("dhtmlx.temp="+a.ai.responseText+";"),a=dhtmlx.temp;for(var b=0;b<a.length;b++){var c=b+1;this.aD.push({idd:c,data:a[b],_parser:this._process_jsarray_row,_locator:this._get_jsarray_data});this.bj[c]=a[b]}this.render_dataset();this._parsing= !1},_process_csv:function(a){this._parsing= !0;if(a.ai)a=a.ai.responseText;a=a.replace(/\r/g,"");a=a.split(this.csv.row);if(this.KY){this.clearAll();var b=a.splice(0,1)[0].split(this.csv.cell);this.Sz||b.splice(0,1);this.setHeader(b.join(this.gX));this.init()}for(var c=0;c<a.length;c++)if(a[c]||c!=a.length-1){if(this.Sz){var d=c+1;this.aD.push({idd:d,data:a[c],_parser:this._process_csv_row,_locator:this._get_csv_data})}else{var e=a[c].split(this.csv.cell),d=e.splice(0,1)[0];this.aD.push({idd:d,data:e,_parser:this._process_jsarray_row,_locator:this._get_jsarray_data})}this.bj[d]=a[c]}this.render_dataset();this._parsing= !1},_process_js:function(a){return this._process_json(a,"js")},_process_json:function(a,b){this._parsing= !0;if(a&&a.ai)eval("dhtmlx.temp="+a.ai.responseText+";"),a=dhtmlx.temp;if(b=="js"){if(a.data)a=a.data;for(var c=0;c<a.length;c++){var d=a[c],e=d.id||c+1;this.aD.push({idd:e,data:d,_parser:this._process_js_row,_locator:this._get_js_data});this.bj[e]=a[c]}}else for(c=0;c<a.rows.length;c++)e=a.rows[c].id,this.aD.push({idd:e,data:a.rows[c],_parser:this._process_json_row,_locator:this._get_json_data}),this.bj[e]=a[c];if(a.dhx_security)dhtmlx.security_key=a.dhx_security;this.render_dataset();this._parsing= !1},render_dataset:function(a,b){if(this.ahK){if(this._fillers)return this._update_srnd_view();b=Math.min(this._get_view_size()+(this._srnd_pr||0),this.aD.length)}this.aW?(a=Math.max(a||0,(this.ew-1)*this.cu),b=Math.min(this.ew*this.cu,this.aD.length)):(a=a||0,b=b||this.aD.length);for(var c=a;c<b;c++){var d=this.render_row(c);if(d== -1){if(this.tR&&this.callEvent("onDynXLS",[c,this.Cr?this.Cr:b-c]))this.load(this.tR+jv(this.tR)+"posStart="+c+"&count="+(this.Cr?this.Cr:b-c),this._data_type);b=c;break}if(!d.parentNode|| !d.parentNode.tagName)if(this._insertRowAt(d,c),d._attrs.selected||d._attrs.select)this.Th(d,d._attrs.call? !0: !1,!0),d._attrs.selected=d._attrs.select=null;if(this.Hv&&c-a==this.Hv){var e=this;this._context_parsing=this._context_parsing||this._parsing;return this.Bf=window.setTimeout(function(){e.Bf=null;e.render_dataset(c,b);if(!e.Bf)e._context_parsing?e.callEvent("onXLE",[]):e._fixAlterCss(),e.callEvent("onDistributedEnd",[]),e._context_parsing= !1},this.Kb)}}if(this.ahK&& !this._fillers){var h=this.aD.length-b;for(this._fillers=[];h>0;){var i=_isIE?Math.min(h,5E4):h,g=this._add_filler(b,i);g&&this._fillers.push(g);h-=i;b+=i}}this.setSizes()},render_row:function(a){if(!this.aD[a])return-1;if(this.aD[a]._parser){var b=this.aD[a];if(this.bj[b.idd]&&this.bj[b.idd].tagName=="TR")return this.aD[a]=this.bj[b.idd];var c=this.uO(b.idd);this.aD[a]=c;this.bj[b.idd]=c;b._parser.call(this,c,b.data);this.jQ(c);return c}return this.aD[a]},_get_cell_value:function(a,b,c){return a._locator?(this._c_order&&(b=this._c_order[b]),a._locator.call(this,a.data,b)):this.cells3(a,b)[c?c:"getValue"]()},xK:function(a,b,c){c=(c||"asc").toLowerCase();b=b||this.fldSort[a];a=a||0;if(this.gY())this.sT(a,b,c);else{var d={},e=this.cellType[a],h="getValue";e=="link"&&(h="getContent");if(e=="dhxCalendar"||e=="dhxCalendarA")h="getDate";for(var i=0;i<this.aD.length;i++)d[this.aD[i].idd]=this._get_cell_value(this.aD[i],a,h);this.vP(a,b,c,d)}this.callEvent("onAfterSorting",[a,b,c])},aeo:function(a,b,c,d,e){var h="sort";if(this.agg)e.stablesort=this.am.stablesort,h="stablesort";b.length>4&&(b=window[b]);if(b=="cus"){var i=this._customSorts[a];e[h](function(a,b){return i(d[a.idd],d[b.idd],c,a.idd,b.idd)})}else if(typeof b=="function")e[h](function(a,e){return b(d[a.idd],d[e.idd],c,a.idd,e.idd)});else if(b=="str")e[h](function(a,b){return c=="asc"?d[a.idd]>d[b.idd]?1: -1:d[a.idd]<d[b.idd]?1: -1});else if(b=="int")e[h](function(a,b){var e=parseFloat(d[a.idd]),e=isNaN(e)? -99999999999999:e,i=parseFloat(d[b.idd]),i=isNaN(i)? -99999999999999:i;return c=="asc"?e-i:i-e});else if(b=="date")e[h](function(a,b){var e=Date.parse(d[a.idd])||Date.parse("01/01/1900"),i=Date.parse(d[b.idd])||Date.parse("01/01/1900");return c=="asc"?e-i:i-e})},vP:function(a,b,c,d){this.aeo(a,b,c,d,this.aD);this._reset_view();this.callEvent("onGridReconstructed",[])},_reset_view:function(a){if(this.obj.rows[0]){this.callEvent("onResetView",[]);var b=this.obj.rows[0].parentNode,c=b.removeChild(b.childNodes[0],!0);if(cn)for(var d=b.parentNode.childNodes.length-1;d>=0;d--)b.parentNode.childNodes[d].tagName=="TR"&&b.parentNode.removeChild(b.parentNode.childNodes[d],!0);else if(_isIE)for(d=b.childNodes.length-1;d>=0;d--)b.childNodes[d].removeNode(!0);else b.innerHTML="";b.appendChild(c);this.am=dhtmlxArray();this.agg&&this.enableStableSorting(!0);this._fillers=this.undefined;a||this.render_dataset()}},deleteRow:function(a,b){b||(b=this.dz(a));if(b){this.editStop();if(!this.nh&&this.callEvent("onBeforeRowDeleted",[a])== !1)return!1;var c=0;if(this.cellType.bP("tree")!= -1&& !this.nh)c=this._h2.get[a].parent.id,this.yE(b);else{b.parentNode&&b.parentNode.removeChild(b);var d=this.am.bP(b);d!= -1&&this.am.at(d);for(var e=0;e<this.aD.length;e++)if(this.aD[e]&&this.aD[e].idd==a){this.aD.at(e);d=e;break}}this.bj[a]=null;for(e=0;e<this.bY.length;e++)this.bY[e].idd==a&&this.bY.at(e);if(this.ahK){for(e=0;e<this._fillers.length;e++){var h=this._fillers[e];h&&(h[0]>=d?h[0]-=1:h[1]>=d&&(h[1]-=1))}this._update_srnd_view()}this.aW&&this.changePage();this.nh||this.callEvent("onAfterRowDeleted",[a,c]);this.callEvent("onGridReconstructed",[]);this.abK&&this.setSizes();return!0}},ait:function(a,b,c){if(c== -1||typeof c=="undefined")c=this.aD.length;typeof b=="string"&&(b=b.split(this.gX));var d=this.uO(a);d._attrs={};for(var e=0;e<d.childNodes.length;e++)d.childNodes[e]._attrs={};this.bj[d.idd]=d;if(this._h2)this._h2.get[d.idd].buff=d;this.VQ(d,b);this.jQ(d);if(this.WX)return this.WX= !1,this.bj[d.idd]=d;if(this.aW)return this.aD.ml(c,d),this.bj[d.idd]=d;if(this._fillers){this.am.ml(c,null);this.aD.ml(c,d);this.aC&&this.aC.am.ml(c,null);this.bj[d.idd]=d;for(var h= !1,i=0;i<this._fillers.length;i++){var g=this._fillers[i];if(g&&g[0]<=c&&g[0]+g[1]>=c)g[1]+=1,g[2].firstChild.style.height=parseInt(g[2].firstChild.style.height)+this.ig+"px",h= !0,this.aC&&this.aC._fillers[i][1]++;g&&g[0]>c&&(g[0]+=1,this.aC&&this.aC._fillers[i][0]++)}h||this._fillers.push(this._add_filler(c,1,c==0?{parentNode:this.obj.rows[0].parentNode,nextSibling:this.am[1]}:this.am[c-1]));return d}this.aD.ml(c,d);return this._insertRowAt(d,c)},hY:function(a,b,c){var d=this.ait(a,b,c);this.fX||this.callEvent("onRowAdded",[a]);this.aW&&this.changePage(this.ew);this.ahK&&this._update_srnd_view();d.adM= !0;this.abK&&this.setSizes();this.callEvent("onGridReconstructed",[]);return d},_insertRowAt:function(a,b,c){this.bj[a.idd]=a;if(this.WX)return this.WX= !1,a;if(b<0|| !b&&parseInt(b)!==0)b=this.am.length;else if(b>this.am.length)b=this.am.length;this.hC&&(a.className+=(this.Cw?this.sS(a.idd):b)%2==1?" "+this.iI+(this.Vh?" "+this.iI+"_"+this.sS(a.idd):""):" "+this.hC+(this.Vh?" "+this.hC+"_"+this.sS(a.idd):""));c||(b==this.obj.rows.length-1|| !this.am[b]?cn?this.obj.appendChild(a):this.obj.firstChild.appendChild(a):this.am[b].parentNode.insertBefore(a,this.am[b]));this.am.ml(b,a);this.callEvent("onRowInserted",[a,b]);return a},dz:function(a){var b=this.bj[a];if(b){if(b.tagName!="TR"){for(var c=0;c<this.aD.length;c++)if(this.aD[c]&&this.aD[c].idd==a)return this.render_row(c);if(this._h2)return this.render_row(null,b.idd)}return b}return null},apX:function(a,b){return this.cells(a,b)},cells:function(a,b){if(arguments.length==0)return this.cells4(this.cell);else var c=this.dz(a);var d=c.bq?c.childNodes[c.bq[b]]:c.childNodes[b];return this.cells4(d)},amP:function(a,b){return this.cells2(a,b)},cells2:function(a,b){var c=this.render_row(a),d=c.bq?c.childNodes[c.bq[b]]:c.childNodes[b];return this.cells4(d)},cells3:function(a,b){var c=a.bq?a.childNodes[a.bq[b]]:a.childNodes[b];return this.cells4(c)},cells4:function(a){var b=window["eXcell_"+(a.zk||this.cellType[a._cellIndex])];if(b)return new b(a)},adH:function(a,b){b=b||a.zk||this.cellType[a._cellIndex];if(!this.XC[b]){var c=window["eXcell_"+b]?window["eXcell_"+b]:eXcell_ro;this.XC[b]=new c(a)}this.XC[b].cell=a;return this.XC[b]},dma:function(a){if(!this.XC)this.XC={};if(a&& !this.abp)this.abp=this.cells4,this.cells4=this.adH;else if(!a&&this.abp)this.cells4=this.abp,this.abp=null},iD:function(){return this.aD.length},enableEditTabOnly:function(a){this.smartTabOrder=arguments.length>0?ap(a): !0},setExternalTabOrder:function(a,b){var c=this;this.tabStart=typeof a=="object"?a:document.getElementById(a);this.tabStart.onkeydown=function(a){var b=a||window.event;if(b.keyCode==9&& !b.shiftKey)return b.cancelBubble= !0,c.eQ(0,0,0,0,1),c.smartTabOrder&&c.cells2(0,0).isDisabled()&&c.zf.k9_0_0.call(c),this.blur(),!1};if(cU)this.tabStart.onkeypress=this.tabStart.onkeydown;this.tabEnd=typeof b=="object"?b:document.getElementById(b);this.tabEnd.onkeydown=this.tabEnd.onkeypress=function(a){var b=a||window.event;if(b.keyCode==9&&b.shiftKey)return b.cancelBubble= !0,c.eQ(c.iD()-1,c.So()-1,0,0,1),c.smartTabOrder&&c.cells2(c.iD()-1,c.So()-1).isDisabled()&&c.zf.k9_0_1.call(c),this.blur(),!1};if(cU)this.tabEnd.onkeypress=this.tabEnd.onkeydown},uid:function(){if(!this._ui_seed)this._ui_seed=(new Date).valueOf();return this._ui_seed++},clearAndLoad:function(){var a=this._pgn_skin;this._pgn_skin=null;this.clearAll();this._pgn_skin=a;this.load.apply(this,arguments)},ajA:function(){if(this.aW){var a=(this.ew-1)*this.cu;return[this.ew,a,Math.min(a+this.cu,this.aD.length),this.aD.length]}return[Math.floor(this.HF.scrollTop/this.ig),Math.ceil(parseInt(this.HF.offsetHeight)/this.ig),this.aD.length]}};(function(){function a(a,b){this[a]=b}function b(a,b){this[a].call(this,b)}function c(a,b){this[a].call(this,b.join(this.gX))}function d(a,b){for(var c=0;c<b.length;c++)if(typeof b[c]=="object"){var d=this.cf(c),e;for(e in b[c])d.eT(e,b[c][e])}}function e(a,b){function c(a,b,d){e[b]||(e[b]=[]);if(typeof d=="object")d.toString=function(){return this.text};e[b][a]=d}for(var d=1,e=[],h=0;h<b.length;h++)if(typeof b[h]=="object"&&b[h].length)for(var k=0;k<b[h].length;k++)c(h,k,b[h][k]);else c(h,0,b[h]);for(h=0;h<e.length;h++)for(k=0;k<e[0].length;k++){var n=e[h][k];e[h][k]=(n||"").toString()||"&nbsp;";if(n&&n.colspan)for(var o=1;o<n.colspan;o++)c(k+o,h,"#cspan");if(n&&n.rowspan)for(o=1;o<n.rowspan;o++)c(k,h+o,"#rspan")}this.setHeader(e[0]);for(h=1;h<e.length;h++)this.attachHeader(e[h])}var h=[{name:"label",def:"&nbsp;",operation:"setHeader",type:e},{name:"id",def:"",operation:"columnIds",type:a},{name:"width",def:"*",operation:"setInitWidths",type:c},{name:"align",def:"left",operation:"cellAlign",type:a},{name:"valign",def:"middle",operation:"cellVAlign",type:a},{name:"sort",def:"na",operation:"fldSort",type:a},{name:"type",def:"ro",operation:"setColTypes",type:c},{name:"options",def:"",operation:"",type:d}];dhtmlx.extend_api("dhtmlXGridObject",{ahY:function(a){return[a.parent]},image_path:"setImagePath",columns:"columns",rows:"rows",headers:"headers",skin:"setSkin",smart_rendering:"enableSmartRendering",css:"enableAlterCss",auto_height:"enableAutoHeight",save_hidden:"enableAutoHiddenColumnsSaving",save_cookie:"enableAutoSaving",save_size:"enableAutoSizeSaving",auto_width:"enableAutoWidth",block_selection:"enableBlockSelection",csv_id:"enableCSVAutoID",csv_header:"enableCSVHeader",cell_ids:"enableCellIds",colspan:"enableColSpan",column_move:"enableColumnMove",context_menu:"enableContextMenu",distributed:"enableDistributedParsing",drag:"enableDragAndDrop",drag_order:"enableDragOrder",tabulation:"enableEditTabOnly",header_images:"enableHeaderImages",header_menu:"enableHeaderMenu",keymap:"enableKeyboardSupport",mouse_navigation:"enableLightMouseNavigation",markers:"enableMarkedCells",math_editing:"enableMathEditing",math_serialization:"enableMathSerialization",drag_copy:"enableMercyDrag",multiline:"enableMultiline",multiselect:"enableMultiselect",save_column_order:"enableOrderSaving",hover:"enableRowsHover",rowspan:"enableRowspan",smart:"enableSmartRendering",save_sorting:"enableSortingSaving",stable_sorting:"enableStableSorting",undo:"enableUndoRedo",csv_cell:"setCSVDelimiter",date_format:"setDateFormat",drag_behavior:"setDragBehavior",editable:"setEditable",without_header:"setNoHeader",submit_changed:"submitOnlyChanged",submit_serialization:"submitSerialization",submit_selected:"submitOnlySelected",submit_id:"submitOnlyRowID",xml:"load"},{columns:function(a){for(var c=0;c<h.length;c++){for(var d=[],e=0;e<a.length;e++)d[e]=a[e][h[c].name]||h[c].def;var l=h[c].type||b;l.call(this,h[c].operation,d,a)}this.init()},rows:function(){},headers:function(a){for(var b=0;b<a.length;b++)this.attachHeader(a[b])}})})();dhtmlXGridObject.prototype._dp_init=function(a){a.attachEvent("insertCallback",function(a,c){this.obj._h2?this.obj.hY(c,d,null,parent):this.obj.hY(c,[],0);var d=this.obj.dz(c);d&&(this.obj._process_xml_row(d,a.firstChild),this.obj.jQ(d))});a.attachEvent("updateCallback",function(a,c){var d=this.obj.dz(c);d&&(this.obj._process_xml_row(d,a.firstChild),this.obj.jQ(d))});a.attachEvent("deleteCallback",function(a,c){this.obj.setUserData(c,this.action_param,"true_deleted");this.obj.deleteRow(c)});a._methods=["setRowTextStyle","setCellTextStyle","changeRowId","deleteRow"];this.attachEvent("onEditCell",function(b,c,d){if(a._columns&& !a._columns[d])return!0;var e=this.cells(c,d);b==1?e.wI()&&a.setUpdated(c,!0):b==2&&e.hy()&&a.setUpdated(c,!0);return!0});this.attachEvent("onRowPaste",function(b){a.setUpdated(b,!0)});this.attachEvent("onRowIdChange",function(b,c){var d=a.iv(b);d<a.bE.length&&(a.bE[d]=c)});this.attachEvent("onSelectStateChanged",function(){a.cJ=="row"&&a.sendData();return!0});this.attachEvent("onEnter",function(){a.cJ=="row"&&a.sendData();return!0});this.attachEvent("onBeforeRowDeleted",function(b){if(!this.bj[b])return!0;if(this.fX&&a.dnd)return window.setTimeout(function(){a.setUpdated(b,!0)},1),!0;var c=a.YA(b);this._h2&&this._h2.so(b,function(b){a.setUpdated(b.id,!1);a.markRow(b.id,!0,"deleted")},this);if(c=="inserted")return a.set_invalid(b,!1),a.setUpdated(b,!1),!0;if(c=="deleted")return!1;if(c=="true_deleted")return a.setUpdated(b,!1),!0;a.setUpdated(b,!0,"deleted");return!1});this.attachEvent("onBindUpdate",function(b){a.setUpdated(b,!0)});this.attachEvent("onRowAdded",function(b){if(this.fX&&a.dnd)return!0;a.setUpdated(b,!0,"inserted");return!0});a.fD=function(a){var c=[];c.gr_id=a;this.obj.gY()&&(c.gr_pid=this.obj.getParentId(a));for(var d=this.obj.dz(a),e=0;e<this.obj.gA;e++){var h=this.obj._c_order?this.obj._c_order[e]:e,i=this.obj.cells(d.idd,e);if(!this._changed||i.hy())this.iO?c[this.obj.getColumnId(e)]=i.getValue():c["c"+h]=i.getValue()}var g=this.obj.bH[a];if(g)for(var f=0;f<g.kk.length;f++)g.kk[f]&&g.kk[f].indexOf("__")!=0&&(c[g.kk[f]]=g.values[f]);if(g=this.obj.bH.gridglobaluserdata)for(f=0;f<g.kk.length;f++)c[g.kk[f]]=g.values[f];return c};a._clearUpdateFlag=function(a){var c=this.obj.dz(a);if(c)for(var d=0;d<this.obj.gA;d++)this.obj.cells(a,d).cell.hy= !1};a.aZ=function(a){for(var c= !0,d=[],e=0;e<this.obj.gA;e++)if(this.az[e]){var h=this.az[e].call(this.obj,this.obj.cells(a,e).getValue(),a,e);typeof h=="string"?(this.messages.push(h),c= !1):(c&=h,d[e]= !h)}c||(this.set_invalid(a,"invalid",d),this.setUpdated(a,!1));return c}};